"use strict";(self.webpackChunkfront_simple=self.webpackChunkfront_simple||[]).push([[876],{5135:(U,$,p)=>{p.d($,{G:()=>P});var t=p(177),e=p(4438),l=p(9417);const T=(s,F)=>F.id,h=(s,F)=>F.key,A=()=>[];function _(s,F){if(1&s&&e.nrm(0,"textarea",5),2&s){const r=e.XpG().$implicit,g=e.XpG();e.Y8G("id",r.id)("formControl",r.formControl)("placeholder",r.placeholder||"")("rows",g.rows())}}function R(s,F){if(1&s&&(e.j41(0,"option",8),e.EFF(1),e.k0s()),2&s){const r=e.XpG(2).$implicit;e.R7$(),e.SpI("Select ",r.label,"")}}function S(s,F){if(1&s&&(e.j41(0,"option",9),e.EFF(1),e.k0s()),2&s){const r=F.$implicit;e.Y8G("value",r.id),e.R7$(),e.JRh(r.label)}}function b(s,F){if(1&s&&(e.j41(0,"select",7),e.DNE(1,R,2,1,"option",8),e.Z7z(2,S,2,2,"option",9,T),e.k0s()),2&s){const r=e.XpG().$implicit;e.Y8G("id",r.id)("formControl",r.formControl),e.R7$(),e.vxM(1,r.hideEmptyOptions?-1:1),e.R7$(),e.Dyx(r.options||e.lJ4(3,A))}}function B(s,F){if(1&s&&e.nrm(0,"input",10),2&s){const r=e.XpG().$implicit;e.Y8G("type",r.type)("id",r.id)("formControl",r.formControl)("placeholder",r.placeholder||"")}}function u(s,F){if(1&s&&(e.j41(0,"small"),e.EFF(1),e.k0s()),2&s){const r=e.XpG().$implicit,g=e.XpG(2).$implicit;e.R7$(),e.JRh(g.errors[r.key])}}function v(s,F){if(1&s&&e.DNE(0,u,2,1,"small"),2&s){const r=F.$implicit,g=e.XpG(2).$implicit;e.vxM(0,g.errors&&g.errors[r.key]?0:-1)}}function G(s,F){if(1&s&&(e.j41(0,"div",6),e.Z7z(1,v,1,1,null,null,h),e.nI1(3,"keyvalue"),e.k0s()),2&s){const r=e.XpG().$implicit;e.R7$(),e.Dyx(e.bMT(3,0,r.formControl.errors))}}function j(s,F){if(1&s&&(e.j41(0,"div")(1,"div",1)(2,"label",4),e.EFF(3),e.k0s(),e.DNE(4,_,1,4,"textarea",5)(5,b,4,4)(6,B,1,4)(7,G,4,2,"div",6),e.k0s()()),2&s){const r=F.$implicit,g=e.XpG();e.HbH(g.columnClass()),e.R7$(2),e.Y8G("for",r.id),e.R7$(),e.JRh(r.label),e.R7$(),e.vxM(4,"textarea"===r.type?4:"select"===r.type?5:6),e.R7$(3),e.vxM(7,r.formControl.invalid&&r.formControl.touched&&r.errors?7:-1)}}let P=(()=>{class s{constructor(){this.formGroup=e.hFB.required(),this.fields=e.hFB.required(),this.title=(0,e.hFB)("Section"),this.columns=(0,e.hFB)(1),this.rows=(0,e.hFB)(3),this.columnClass=(0,e.EWP)(()=>1===this.columns()?"col-12":"col-md-"+12/this.columns())}static{this.\u0275fac=function(g){return new(g||s)}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-artwork-fieldset"]],inputs:{formGroup:[e.Mj6.SignalBased,"formGroup"],fields:[e.Mj6.SignalBased,"fields"],title:[e.Mj6.SignalBased,"title"],columns:[e.Mj6.SignalBased,"columns"],rows:[e.Mj6.SignalBased,"rows"]},standalone:!0,features:[e.aNF],decls:6,vars:1,consts:[[1,"mb-4"],[1,"mb-3"],[1,"row"],[3,"class"],[1,"form-label",3,"for"],[1,"form-control",3,"id","formControl","placeholder","rows"],[1,"text-danger","mt-1"],[1,"form-select",3,"id","formControl"],["value",""],[3,"value"],[1,"form-control",3,"type","id","formControl","placeholder"]],template:function(g,d){1&g&&(e.j41(0,"div",0)(1,"h5",1),e.EFF(2),e.k0s(),e.j41(3,"div",2),e.Z7z(4,j,8,6,"div",3,T),e.k0s()()),2&g&&(e.R7$(2),e.JRh(d.title()),e.R7$(2),e.Dyx(d.fields()))},dependencies:[l.X1,l.xH,l.y7,l.me,l.wz,l.BC,l.l_,t.MD,t.lG]})}}return s})()},190:(U,$,p)=>{p.d($,{DC:()=>j,Xj:()=>F,_z:()=>K});var t=p(467),e=p(4438),l=p(9417),T=p(177),h=p(5794),A=p(4221),_=p(1367),R=p(5135),S=p(7533);function b(c,w){if(1&c&&e.nrm(0,"video",18),2&c){const o=e.XpG().$implicit;e.Y8G("src",o,e.B4B)}}function B(c,w){if(1&c&&e.nrm(0,"img",19),2&c){const o=e.XpG().$implicit;e.Y8G("src",o,e.B4B)}}function u(c,w){if(1&c&&(e.j41(0,"div",16),e.DNE(1,b,1,1,"video",18)(2,B,1,1),e.k0s()),2&c){const o=w.$implicit,a=e.XpG(2);e.R7$(),e.vxM(1,a.isVideo(o)?1:2)}}function v(c,w){if(1&c&&(e.j41(0,"div",17)(1,"small",20),e.nrm(2,"i",21),e.EFF(3," Aspect Ratio: "),e.j41(4,"strong"),e.EFF(5),e.k0s()()()),2&c){const o=e.XpG(2);e.R7$(5),e.JRh(o.aspectRatio)}}function G(c,w){if(1&c&&(e.j41(0,"div",9)(1,"div",11),e.Z7z(2,u,3,1,"div",16,e.Vm6),e.k0s(),e.DNE(4,v,6,1,"div",17),e.k0s()),2&c){const o=e.XpG();e.R7$(2),e.Dyx(o.previewUrls),e.R7$(2),e.vxM(4,o.aspectRatio?4:-1)}}let j=(()=>{class c{constructor(){this.toastr=(0,e.WQX)(h.tw),this.modal=(0,e.WQX)(A.Lw),this.isVideo=S.A,this._artwork=null,this._seriesOptions=[],this.selectedFiles=[],this.previewUrls=[],this.aspectRatio="",this.formArtwork=new l.gE({title:new l.MJ("",{validators:[l.k0.required,l.k0.maxLength(100)],nonNullable:!0}),type:new l.MJ("",{validators:[l.k0.required],nonNullable:!0}),yearOfCreation:new l.MJ(null),heightCm:new l.MJ(null),widthCm:new l.MJ(null),technique:new l.MJ("",{nonNullable:!0}),medium:new l.MJ("",{nonNullable:!0}),copies:new l.MJ("",{nonNullable:!0}),web:new l.MJ("",{nonNullable:!0}),price:new l.MJ(null),description:new l.MJ("",{nonNullable:!0}),seriesId:new l.MJ("",{nonNullable:!0}),editionNumber:new l.MJ(null),totalEditions:new l.MJ(null)}),this.artworkTypes=Object.values(_.H2).map(o=>({id:o,label:o.charAt(0).toUpperCase()+o.slice(1).toLowerCase()})),this.fields={basicInfo:[{formControl:this.formArtwork.controls.title,id:"title",label:"Artwork Title",name:"title",type:"text",placeholder:"Title of your artwork",errors:{required:"Title is required",maxlength:"Title cannot exceed 100 characters"}},{formControl:this.formArtwork.controls.type,id:"type",label:"Artwork Type",name:"type",type:"select",placeholder:"Select artwork type",options:this.artworkTypes,errors:{required:"Type is required"}},{formControl:this.formArtwork.controls.description,id:"description",label:"Description",name:"description",type:"textarea",placeholder:"Describe your artwork"}],details:[{formControl:this.formArtwork.controls.yearOfCreation,id:"yearOfCreation",label:"Year of Creation",name:"yearOfCreation",type:"number"},{formControl:this.formArtwork.controls.technique,id:"technique",label:"Technique",name:"technique",type:"text"},{formControl:this.formArtwork.controls.medium,id:"medium",label:"Medium",name:"medium",type:"text"},{formControl:this.formArtwork.controls.editionNumber,id:"editionNumber",label:"Edition Number",name:"editionNumber",type:"number",placeholder:"e.g., 2"},{formControl:this.formArtwork.controls.totalEditions,id:"totalEditions",label:"Total Editions",name:"totalEditions",type:"number",placeholder:"e.g., 10"}],dimensions:[{formControl:this.formArtwork.controls.heightCm,id:"heightCm",label:"Height (cm)",name:"heightCm",type:"number"},{formControl:this.formArtwork.controls.widthCm,id:"widthCm",label:"Width (cm)",name:"widthCm",type:"number"}],additional:[{formControl:this.formArtwork.controls.seriesId,id:"seriesId",label:"Series",name:"seriesId",type:"select",options:[]},{formControl:this.formArtwork.controls.price,id:"price",label:"Price",name:"price",type:"number"}]}}get artwork(){return this._artwork}set artwork(o){this._artwork=o,o?this.initFormWithArtwork(o):this.resetForm()}get seriesOptions(){return this._seriesOptions}set seriesOptions(o){this._seriesOptions=o}ngOnInit(){this.updateSeriesOptions()}updateSeriesOptions(){this.fields.additional[0].options=[{id:"",label:"None (standalone artwork)"},...this.seriesOptions]}calculateAspectRatio(o,a){const n=(y,E)=>0===E?y:n(E,y%E),m=n(o,a);return`${o/m}:${a/m}`}getImageDimensions(o){return new Promise((a,n)=>{if(o.type.startsWith("image/")){const m=new Image;m.onload=()=>{a({width:m.width,height:m.height})},m.onerror=n,m.src=URL.createObjectURL(o)}else if(o.type.startsWith("video/")){const m=document.createElement("video");m.onloadedmetadata=()=>{a({width:m.videoWidth,height:m.videoHeight}),URL.revokeObjectURL(m.src)},m.onerror=n,m.src=URL.createObjectURL(o)}else n(new Error("Unsupported file type for dimension calculation"))})}initFormWithArtwork(o){this.resetForm(),this.formArtwork.patchValue({title:o.title,type:o.type,yearOfCreation:o.yearOfCreation||null,heightCm:o.heightCm||null,widthCm:o.widthCm||null,technique:o.technique||"",medium:o.medium||"",copies:o.copies||"",web:o.web||"",price:o.price||null,description:o.description||"",seriesId:o.seriesId||"",editionNumber:o.editionNumber||null,totalEditions:o.totalEditions||null}),this.previewUrls=[o.fileUrl]}onFilesSelected(o){var a=this;return(0,t.A)(function*(){const n=o.target;if(!n.files?.length)return;a.artwork||(a.selectedFiles=[],a.previewUrls=[],a.aspectRatio="");const m=Array.from(n.files);let y=!1;const E=[];for(const M of m){if(M.size>10485760){a.toastr.error(`File "${M.name}" exceeds 10MB size limit`),y=!0;continue}const D=M.name.split(".").pop()?.toLowerCase();if(!D||!["jpg","jpeg","png","webm","mp4","gif","txt"].includes(D)){a.toastr.error(`File "${M.name}" has unsupported format`),y=!0;continue}if(M.type.startsWith("image/")||M.type.startsWith("video/"))try{const I=yield a.getImageDimensions(M),V=Math.max(I.width,I.height);if(M.type.startsWith("image/")&&V>720){a.toastr.error(`Image "${M.name}" exceeds 720px maximum dimension (${I.width}x${I.height})`),y=!0;continue}if(M.type.startsWith("video/")&&V>1080){a.toastr.error(`Video "${M.name}" exceeds 1080px maximum dimension (${I.width}x${I.height})`),y=!0;continue}a.aspectRatio=a.calculateAspectRatio(I.width,I.height),console.log(`Aspect ratio calculated: ${a.aspectRatio} (${I.width}x${I.height})`)}catch(I){console.warn("Could not calculate dimensions:",I),a.aspectRatio="1:1"}else a.aspectRatio="1:1";E.push(M);const N=new FileReader;N.onload=()=>{a.previewUrls.push(N.result)},N.readAsDataURL(M)}a.selectedFiles=[...a.selectedFiles,...E],y&&0===E.length&&(n.value="")})()}resetForm(){this.formArtwork.reset(),this.selectedFiles=[],this.previewUrls=[],this.aspectRatio="",this.formArtwork.patchValue({type:"",technique:"",medium:"",copies:"",web:"",description:"",seriesId:""})}saveArtwork(){if(!this.formArtwork.valid)return this.formArtwork.markAllAsTouched(),void this.toastr.error("Please correct the errors in the form");if(!this.artwork&&0===this.selectedFiles.length)return void this.toastr.error("Please select at least one file for your artwork");const o=this.formArtwork.getRawValue();o.editionNumber&&o.totalEditions&&o.editionNumber>o.totalEditions?this.toastr.error("Edition number cannot be greater than total editions"):this.modal.close({formData:{title:o.title,type:o.type,yearOfCreation:o.yearOfCreation||void 0,heightCm:o.heightCm||void 0,widthCm:o.widthCm||void 0,technique:o.technique,medium:o.medium,copies:o.copies,web:o.web,price:o.price||void 0,description:o.description,seriesId:o.seriesId||void 0,editionNumber:o.editionNumber||void 0,totalEditions:o.totalEditions||void 0},files:this.selectedFiles,aspectRatio:this.aspectRatio})}static{this.\u0275fac=function(a){return new(a||c)}}static{this.\u0275cmp=e.VBU({type:c,selectors:[["app-artwork-modal"]],standalone:!0,features:[e.aNF],decls:25,vars:17,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],[1,"mb-4"],["for","fileUpload",1,"form-label"],["type","file","id","fileUpload","accept",".jpg,.jpeg,.png,.webm,.mp4,.gif,.txt",1,"form-control",3,"change","multiple"],[1,"form-text"],[1,"mt-3"],[3,"formGroup","fields","title"],[1,"row"],[1,"col-md-6"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[1,"col-md-3","mb-2"],[1,"mt-2"],["autoplay","","loop","","muted","",1,"img-thumbnail",2,"height","100px","width","100%","object-fit","cover",3,"src"],["alt","Preview",1,"img-thumbnail",2,"height","100px","width","100%","object-fit","cover",3,"src"],[1,"text-muted"],[1,"fa","fa-info-circle"]],template:function(a,n){1&a&&(e.j41(0,"div",0)(1,"h5",1),e.EFF(2),e.k0s(),e.j41(3,"button",2),e.bIt("click",function(){return n.modal.dismiss()}),e.k0s()(),e.j41(4,"div",3)(5,"form",4)(6,"div",5)(7,"label",6),e.EFF(8,"Artwork File"),e.k0s(),e.j41(9,"input",7),e.bIt("change",function(y){return n.onFilesSelected(y)}),e.k0s(),e.j41(10,"div",8),e.EFF(11," Supported formats: JPG, PNG, WEBM, MP4, GIF, TXT (Max 10MB) "),e.k0s(),e.DNE(12,G,5,1,"div",9),e.k0s(),e.nrm(13,"app-artwork-fieldset",10),e.j41(14,"div",11)(15,"div",12),e.nrm(16,"app-artwork-fieldset",10),e.k0s(),e.j41(17,"div",12),e.nrm(18,"app-artwork-fieldset",10),e.k0s()(),e.nrm(19,"app-artwork-fieldset",10),e.k0s()(),e.j41(20,"div",13)(21,"button",14),e.bIt("click",function(){return n.modal.dismiss()}),e.EFF(22,"Cancel"),e.k0s(),e.j41(23,"button",15),e.bIt("click",function(){return n.saveArtwork()}),e.EFF(24),e.k0s()()),2&a&&(e.R7$(2),e.JRh(n.artwork?"Edit Artwork":"Add New Artwork"),e.R7$(3),e.Y8G("formGroup",n.formArtwork),e.R7$(4),e.Y8G("multiple",!n.artwork),e.R7$(3),e.vxM(12,n.previewUrls.length>0?12:-1),e.R7$(),e.Y8G("formGroup",n.formArtwork)("fields",n.fields.basicInfo)("title","Basic Information"),e.R7$(3),e.Y8G("formGroup",n.formArtwork)("fields",n.fields.details)("title","Details"),e.R7$(2),e.Y8G("formGroup",n.formArtwork)("fields",n.fields.dimensions)("title","Dimensions"),e.R7$(),e.Y8G("formGroup",n.formArtwork)("fields",n.fields.additional)("title","Additional Information"),e.R7$(5),e.SpI(" ",n.artwork?"Update Artwork":"Add Artwork"," "))},dependencies:[l.X1,l.qT,l.cb,l.j4,T.MD,R.G],encapsulation:2})}}return c})();function s(c,w){if(1&c&&(e.j41(0,"div",5)(1,"h6"),e.EFF(2,"Preview:"),e.k0s(),e.nrm(3,"img",15),e.k0s()),2&c){const o=e.XpG();e.R7$(3),e.Y8G("src",o.previewUrl,e.B4B)}}p(8194);let F=(()=>{class c{constructor(){this.toastr=(0,e.WQX)(h.tw),this.modal=(0,e.WQX)(A.Lw),this.textureType=_.Ap.FLOOR,this.previewUrl=null,this.selectedFile=null,this.uploadForm=new l.gE({isPublic:new l.MJ(!1,{nonNullable:!0})})}get typeDisplay(){return this.textureType.charAt(0).toUpperCase()+this.textureType.slice(1).toLowerCase()}getImageDimensions(o){return new Promise((a,n)=>{if(o.type.startsWith("image/")){const m=new Image;m.onload=()=>{a({width:m.width,height:m.height})},m.onerror=n,m.src=URL.createObjectURL(o)}else if(o.type.startsWith("video/")){const m=document.createElement("video");m.onloadedmetadata=()=>{a({width:m.videoWidth,height:m.videoHeight}),URL.revokeObjectURL(m.src)},m.onerror=n,m.src=URL.createObjectURL(o)}else n(new Error("Unsupported file type for dimension calculation"))})}onFileSelected(o){var a=this;return(0,t.A)(function*(){const n=o.target;if(!n.files?.length)return;const m=n.files[0];if(m.size>10485760)return a.toastr.error("File exceeds 10MB size limit"),void(n.value="");const y=m.name.split(".").pop()?.toLowerCase();if(!y||!["jpg","jpeg","png","webm","mp4","gif"].includes(y))return a.toastr.error(`Unsupported file format: ${y}`),void(n.value="");if(m.type.startsWith("image/")||m.type.startsWith("video/"))try{const D=yield a.getImageDimensions(m);if(Math.max(D.width,D.height)>720)return a.toastr.error(`File "${m.name}" exceeds 720px maximum dimension (${D.width}x${D.height})`),void(n.value="")}catch(D){console.warn("Could not calculate dimensions:",D)}a.selectedFile=m;const M=new FileReader;M.onload=()=>{a.previewUrl=M.result},M.readAsDataURL(m)})()}upload(){if(!this.selectedFile)return void this.toastr.error("Please select a file");const o=this.uploadForm.getRawValue();this.modal.close({type:this.textureType,file:this.selectedFile,isPublic:o.isPublic})}static{this.\u0275fac=function(a){return new(a||c)}}static{this.\u0275cmp=e.VBU({type:c,selectors:[["app-texture-upload-modal"]],standalone:!0,features:[e.aNF],decls:23,vars:4,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],[1,"mb-4"],["for","textureFile",1,"form-label"],["type","file","id","textureFile","accept",".jpg,.jpeg,.png,.webm,.mp4,.gif",1,"form-control",3,"change"],[1,"form-text"],[1,"form-check"],["type","checkbox","id","isPublic","formControlName","isPublic",1,"form-check-input"],["for","isPublic",1,"form-check-label"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["alt","Texture preview",1,"img-thumbnail",2,"max-height","200px",3,"src"]],template:function(a,n){1&a&&(e.j41(0,"div",0)(1,"h5",1),e.EFF(2),e.k0s(),e.j41(3,"button",2),e.bIt("click",function(){return n.modal.dismiss()}),e.k0s()(),e.j41(4,"div",3)(5,"form",4)(6,"div",5)(7,"label",6),e.EFF(8,"Select Texture File"),e.k0s(),e.j41(9,"input",7),e.bIt("change",function(y){return n.onFileSelected(y)}),e.k0s(),e.j41(10,"div",8),e.EFF(11," Supported formats: JPG, PNG, WEBM, MP4, GIF (Max 10MB) "),e.k0s()(),e.DNE(12,s,4,1,"div",5),e.j41(13,"div",5)(14,"div",9),e.nrm(15,"input",10),e.j41(16,"label",11),e.EFF(17," Make this texture public (available to other artists) "),e.k0s()()()()(),e.j41(18,"div",12)(19,"button",13),e.bIt("click",function(){return n.modal.dismiss()}),e.EFF(20,"Cancel"),e.k0s(),e.j41(21,"button",14),e.bIt("click",function(){return n.upload()}),e.EFF(22," Upload Texture "),e.k0s()()),2&a&&(e.R7$(2),e.SpI("Upload ",n.typeDisplay," Texture"),e.R7$(3),e.Y8G("formGroup",n.uploadForm),e.R7$(7),e.vxM(12,n.previewUrl?12:-1),e.R7$(9),e.Y8G("disabled",!n.selectedFile))},dependencies:[l.X1,l.qT,l.Zm,l.BC,l.cb,l.j4,l.JD,T.MD]})}}return c})();const r=(c,w)=>w.id,g=(c,w)=>w.key,d=()=>[];function C(c,w){if(1&c&&e.nrm(0,"textarea",22),2&c){const o=e.XpG().$implicit;e.Y8G("id",o.id)("formControl",o.formControl)("placeholder",o.placeholder||"")("rows",o.rows||3)}}function i(c,w){if(1&c&&e.nrm(0,"input",24),2&c){const o=e.XpG().$implicit;e.Y8G("type",o.type)("id",o.id)("formControl",o.formControl)("placeholder",o.placeholder||"")}}function f(c,w){if(1&c&&(e.j41(0,"small"),e.EFF(1),e.k0s()),2&c){const o=e.XpG().$implicit,a=e.XpG(2).$implicit;e.R7$(),e.JRh(a.errors[o.key])}}function k(c,w){if(1&c&&e.DNE(0,f,2,1,"small"),2&c){const o=w.$implicit,a=e.XpG(2).$implicit;e.vxM(0,a.errors&&a.errors[o.key]?0:-1)}}function x(c,w){if(1&c&&(e.j41(0,"div",23),e.Z7z(1,k,1,1,null,null,g),e.nI1(3,"keyvalue"),e.k0s()),2&c){const o=e.XpG().$implicit;e.R7$(),e.Dyx(e.bMT(3,0,o.formControl.errors))}}function O(c,w){if(1&c&&(e.j41(0,"div",6)(1,"label",7),e.EFF(2),e.k0s(),e.DNE(3,C,1,4,"textarea",22)(4,i,1,4)(5,x,4,2,"div",23),e.k0s()),2&c){const o=w.$implicit;e.R7$(),e.Y8G("for",o.id),e.R7$(),e.JRh(o.label),e.R7$(),e.vxM(3,"textarea"===o.type?3:4),e.R7$(2),e.vxM(5,o.formControl.invalid&&o.formControl.touched&&o.errors?5:-1)}}function L(c,w){if(1&c&&(e.j41(0,"option",9),e.EFF(1),e.k0s()),2&c){const o=w.$implicit;e.Y8G("value",o.id),e.R7$(),e.JRh(o.label)}}function J(c,w){1&c&&e.EFF(0," Supported formats: OBJ, GLTF, GLB, FBX, STL (Max 50MB) ")}function W(c,w){1&c&&e.EFF(0," Supported formats: PLY, LAS, PTS, XYZ, DXF (Max 50MB) ")}function X(c,w){if(1&c&&(e.j41(0,"div",15),e.nrm(1,"img",25),e.k0s()),2&c){const o=e.XpG();e.R7$(),e.Y8G("src",o.thumbnailPreview,e.B4B)}}function Y(c,w){if(1&c&&(e.j41(0,"div",15),e.nrm(1,"img",26),e.k0s()),2&c){const o=e.XpG();e.R7$(),e.Y8G("src",o.texturePreview,e.B4B)}}function z(c,w){if(1&c&&(e.j41(0,"div",18),e.nrm(1,"input",27),e.j41(2,"label",28),e.EFF(3),e.k0s()()),2&c){const o=w.$implicit;e.R7$(),e.Y8G("id",o.id)("formControl",o.formControl),e.R7$(),e.Y8G("for",o.id),e.R7$(),e.SpI(" ",o.label," ")}}let K=(()=>{class c{constructor(){this.toastr=(0,e.WQX)(h.tw),this.modal=(0,e.WQX)(A.Lw),this._object=null,this.objectTypeOptions=[{id:_.ex.MESH,label:"Mesh (3D Model)"},{id:_.ex.POINT_CLOUD,label:"Point Cloud"}],this.objectFile=null,this.thumbnailFile=null,this.textureFile=null,this.thumbnailPreview=null,this.texturePreview=null,this.objectForm=new l.gE({title:new l.MJ("",{validators:[l.k0.required,l.k0.maxLength(100)],nonNullable:!0}),shortDescription:new l.MJ("",{validators:[l.k0.required],nonNullable:!0}),description:new l.MJ(""),objectType:new l.MJ(_.ex.MESH,{validators:[l.k0.required],nonNullable:!0}),isPublic:new l.MJ(!1,{nonNullable:!0}),aiGenerated:new l.MJ(!1,{nonNullable:!0})}),this.basicInfoFields=[{formControl:this.objectForm.controls.title,id:"title",label:"Title",name:"title",type:"text",placeholder:"Enter title for your 3D object",errors:{required:"Title is required",maxlength:"Title cannot exceed 100 characters"}},{formControl:this.objectForm.controls.shortDescription,id:"shortDescription",label:"Short Description",name:"shortDescription",type:"text",placeholder:"Brief description (shown in listings)",errors:{required:"Short description is required"}},{formControl:this.objectForm.controls.description,id:"description",label:"Full Description",name:"description",type:"textarea",placeholder:"Detailed description of your 3D object",rows:3}],this.objectTypeField={formControl:this.objectForm.controls.objectType,id:"objectType",label:"Object Type",name:"objectType",type:"select",options:this.objectTypeOptions.map(o=>({id:o.id,label:o.label}))},this.optionFields=[{formControl:this.objectForm.controls.isPublic,id:"isPublic",label:"Make this object publicly available",name:"isPublic",type:"checkbox"},{formControl:this.objectForm.controls.aiGenerated,id:"aiGenerated",label:"This object was AI-generated",name:"aiGenerated",type:"checkbox"}]}get object(){return this._object}set object(o){this._object=o,o&&this.initFormWithObject(o)}initFormWithObject(o){this.objectForm.patchValue({title:o.title,shortDescription:o.shortDescription,description:o.description||"",objectType:o.metadata.objectType,isPublic:o.isPublic,aiGenerated:o.metadata.aiGenerated}),this.thumbnailPreview=o.thumbnailUrl,o.hasTextures&&o.textureCdnUrl&&(this.texturePreview=o.textureCdnUrl)}onObjectFileSelected(o){const a=o.target;if(!a.files?.length)return;const n=a.files[0],m=this.objectForm.get("objectType")?.value,y=n.name.split(".").pop()?.toLowerCase(),D=m===_.ex.MESH?["obj","gltf","glb","gltb","fbx","stl"]:["ply","las","pts","xyz","dxf"];return y&&D.includes(y)?n.size>52428800?(this.toastr.error("File size exceeds 50MB limit"),void(a.value="")):void(this.objectFile=n):(this.toastr.error(`Invalid file format. Supported formats: ${D.join(", ")}`),void(a.value=""))}onThumbnailFileSelected(o){const a=o.target;if(!a.files?.length)return;const n=a.files[0],m=n.name.split(".").pop()?.toLowerCase(),y=["jpg","jpeg","png"];if(!m||!y.includes(m))return this.toastr.error(`Invalid thumbnail format. Supported formats: ${y.join(", ")}`),void(a.value="");if(n.size>5242880)return this.toastr.error("Thumbnail size exceeds 5MB limit"),void(a.value="");this.thumbnailFile=n;const E=new FileReader;E.onload=()=>{this.thumbnailPreview=E.result},E.readAsDataURL(n)}onTextureFileSelected(o){const a=o.target;if(!a.files?.length)return;const n=a.files[0],m=n.name.split(".").pop()?.toLowerCase(),y=["jpg","jpeg","png"];if(!m||!y.includes(m))return this.toastr.error(`Invalid texture format. Supported formats: ${y.join(", ")}`),void(a.value="");if(n.size>5242880)return this.toastr.error("Texture size exceeds 5MB limit"),void(a.value="");this.textureFile=n;const E=new FileReader;E.onload=()=>{this.texturePreview=E.result},E.readAsDataURL(n)}save(){if(this.objectForm.invalid)return this.objectForm.markAllAsTouched(),void this.toastr.error("Please correct the form errors");if(!this.object&&!this.objectFile)return void this.toastr.error("Please select a 3D object file");if(!this.object&&!this.thumbnailFile)return void this.toastr.error("Please provide a thumbnail image");const o=new FormData,a=this.objectForm.getRawValue();Object.entries(a).forEach(([n,m])=>{o.append(n,m.toString())}),this.objectFile&&o.append("objectFile",this.objectFile),this.thumbnailFile&&o.append("thumbnailFile",this.thumbnailFile),this.textureFile&&o.append("textureFile",this.textureFile),console.log("Object file present:",!!this.objectFile),console.log("Thumbnail file present:",!!this.thumbnailFile),console.log("Form values:",this.objectForm.getRawValue()),this.modal.close({formValues:this.objectForm.getRawValue(),objectFile:this.objectFile,thumbnailFile:this.thumbnailFile,textureFile:this.textureFile})}static{this.\u0275fac=function(a){return new(a||c)}}static{this.\u0275cmp=e.VBU({type:c,selectors:[["app-three-d-object-modal"]],standalone:!0,features:[e.aNF],decls:51,vars:13,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],[1,"mb-4"],[1,"mb-3"],[1,"form-label",3,"for"],[1,"form-select",3,"id","formControl","disabled"],[3,"value"],["for","objectFile",1,"form-label"],["type","file","id","objectFile",1,"form-control",3,"change","disabled"],[1,"form-text"],["for","thumbnailFile",1,"form-label"],["type","file","id","thumbnailFile","accept",".jpg,.jpeg,.png",1,"form-control",3,"change"],[1,"mt-2"],["for","textureFile",1,"form-label"],["type","file","id","textureFile","accept",".jpg,.jpeg,.png",1,"form-control",3,"change"],[1,"form-check","mb-3"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[1,"form-control",3,"id","formControl","placeholder","rows"],[1,"text-danger","mt-1"],[1,"form-control",3,"type","id","formControl","placeholder"],["alt","Thumbnail preview",1,"img-thumbnail",2,"height","150px",3,"src"],["alt","Texture preview",1,"img-thumbnail",2,"height","150px",3,"src"],["type","checkbox",1,"form-check-input",3,"id","formControl"],[1,"form-check-label",3,"for"]],template:function(a,n){if(1&a&&(e.j41(0,"div",0)(1,"h5",1),e.EFF(2),e.k0s(),e.j41(3,"button",2),e.bIt("click",function(){return n.modal.dismiss()}),e.k0s()(),e.j41(4,"div",3)(5,"form",4)(6,"div",5)(7,"h6",6),e.EFF(8,"Basic Information"),e.k0s(),e.Z7z(9,O,6,4,"div",6,r),e.k0s(),e.j41(11,"div",5)(12,"h6",6),e.EFF(13,"Object Type & Files"),e.k0s(),e.j41(14,"div",6)(15,"label",7),e.EFF(16),e.k0s(),e.j41(17,"select",8),e.Z7z(18,L,2,2,"option",9,r),e.k0s()(),e.j41(20,"div",6)(21,"label",10),e.EFF(22,"3D Object File"),e.k0s(),e.j41(23,"input",11),e.bIt("change",function(y){return n.onObjectFileSelected(y)}),e.k0s(),e.j41(24,"div",12),e.DNE(25,J,1,0)(26,W,1,0),e.k0s()(),e.j41(27,"div",6)(28,"label",13),e.EFF(29,"Thumbnail Image"),e.k0s(),e.j41(30,"input",14),e.bIt("change",function(y){return n.onThumbnailFileSelected(y)}),e.k0s(),e.j41(31,"div",12),e.EFF(32,"Supported formats: JPG, PNG (Max 5MB)"),e.k0s(),e.DNE(33,X,2,1,"div",15),e.k0s(),e.j41(34,"div",6)(35,"label",16),e.EFF(36,"Texture Image (Optional)"),e.k0s(),e.j41(37,"input",17),e.bIt("change",function(y){return n.onTextureFileSelected(y)}),e.k0s(),e.j41(38,"div",12),e.EFF(39,"Supported formats: JPG, PNG (Max 5MB)"),e.k0s(),e.DNE(40,Y,2,1,"div",15),e.k0s()(),e.j41(41,"div",5)(42,"h6",6),e.EFF(43,"Options"),e.k0s(),e.Z7z(44,z,4,4,"div",18,r),e.k0s()()(),e.j41(46,"div",19)(47,"button",20),e.bIt("click",function(){return n.modal.dismiss()}),e.EFF(48,"Cancel"),e.k0s(),e.j41(49,"button",21),e.bIt("click",function(){return n.save()}),e.EFF(50),e.k0s()()),2&a){let m;e.R7$(2),e.JRh(n.object?"Edit 3D Object":"Upload 3D Object"),e.R7$(3),e.Y8G("formGroup",n.objectForm),e.R7$(4),e.Dyx(n.basicInfoFields),e.R7$(6),e.Y8G("for",n.objectTypeField.id),e.R7$(),e.JRh(n.objectTypeField.label),e.R7$(),e.Y8G("id",n.objectTypeField.id)("formControl",n.objectTypeField.formControl)("disabled",!!n.object),e.R7$(),e.Dyx(n.objectTypeField.options||e.lJ4(12,d)),e.R7$(5),e.Y8G("disabled",!!n.object),e.R7$(2),e.vxM(25,"mesh"===(null==(m=n.objectForm.get("objectType"))?null:m.value)?25:26),e.R7$(8),e.vxM(33,n.thumbnailPreview?33:-1),e.R7$(7),e.vxM(40,n.texturePreview?40:-1),e.R7$(4),e.Dyx(n.optionFields),e.R7$(6),e.SpI(" ",n.object?"Update Object":"Upload Object"," ")}},dependencies:[l.X1,l.qT,l.xH,l.y7,l.me,l.Zm,l.wz,l.BC,l.cb,l.l_,l.j4,T.MD,T.lG],encapsulation:2})}}return c})();p(4942)},4942:(U,$,p)=>{p.d($,{M:()=>P});var t=p(4438),e=p(9417),l=p(177),T=p(4221),h=p(1367),A=p(5794);const _=(s,F)=>F.id;function R(s,F){if(1&s&&t.EFF(0),2&s){const r=t.XpG(2).$implicit;t.SpI(" ",null==r.errors?null:r.errors.required," ")}}function S(s,F){if(1&s&&t.EFF(0),2&s){const r=t.XpG(2).$implicit;t.SpI(" ",null==r.errors?null:r.errors.maxlength," ")}}function b(s,F){if(1&s&&(t.j41(0,"div",22),t.DNE(1,R,1,1)(2,S,1,1),t.k0s()),2&s){const r=t.XpG().$implicit;t.R7$(),t.vxM(1,null!=r.formControl.errors&&r.formControl.errors.required?1:-1),t.R7$(),t.vxM(2,null!=r.formControl.errors&&r.formControl.errors.maxlength?2:-1)}}function B(s,F){if(1&s&&(t.j41(0,"div",6)(1,"label",7),t.EFF(2),t.k0s(),t.nrm(3,"input",21),t.DNE(4,b,3,2,"div",22),t.k0s()),2&s){const r=F.$implicit;t.R7$(),t.Y8G("for",r.id),t.R7$(),t.JRh(r.label),t.R7$(),t.Y8G("type",r.type)("id",r.id)("formControlName",r.name)("placeholder",r.placeholder||""),t.R7$(),t.vxM(4,r.formControl.invalid&&r.formControl.touched?4:-1)}}function u(s,F){if(1&s&&(t.j41(0,"option",9),t.EFF(1),t.k0s()),2&s){const r=F.$implicit;t.Y8G("value",r.id),t.R7$(),t.JRh(r.label)}}function v(s,F){1&s&&(t.j41(0,"span",11),t.EFF(1,"*"),t.k0s())}function G(s,F){if(1&s&&(t.j41(0,"div",16),t.nrm(1,"img",23),t.k0s()),2&s){const r=t.XpG();t.R7$(),t.Y8G("src",r.thumbnailPreview,t.B4B)}}function j(s,F){if(1&s&&(t.j41(0,"div",17),t.nrm(1,"input",24),t.j41(2,"label",25),t.EFF(3),t.k0s()()),2&s){const r=F.$implicit;t.R7$(),t.Y8G("id",r.id)("formControlName",r.name),t.R7$(),t.Y8G("for",r.id),t.R7$(),t.SpI(" ",r.label," ")}}let P=(()=>{class s{constructor(){this.toastr=(0,t.WQX)(A.tw),this.modal=(0,t.WQX)(T.Lw),this._geometry=null,this.geometryTypeOptions=[{id:h.GF.FLOOR,label:"Floor"},{id:h.GF.WALLS,label:"Walls"},{id:h.GF.CEILING,label:"Ceiling"}],this.geometryFile=null,this.thumbnailFile=null,this.thumbnailPreview=null,this.geometryForm=new e.gE({name:new e.MJ("",{validators:[e.k0.required,e.k0.maxLength(200)],nonNullable:!0}),type:new e.MJ(h.GF.FLOOR,{validators:[e.k0.required],nonNullable:!0}),isPublic:new e.MJ(!0,{nonNullable:!0})}),this.basicInfoFields=[{formControl:this.geometryForm.controls.name,id:"name",label:"Geometry Name",name:"name",type:"text",placeholder:"e.g., gallery-1-floor",errors:{required:"Name is required",maxlength:"Name cannot exceed 200 characters"}}],this.typeField={formControl:this.geometryForm.controls.type,id:"type",label:"Geometry Type",name:"type",type:"select",options:this.geometryTypeOptions.map(r=>({id:r.id,label:r.label}))},this.optionFields=[{formControl:this.geometryForm.controls.isPublic,id:"isPublic",label:"Make this geometry publicly available",name:"isPublic",type:"checkbox"}]}get geometry(){return this._geometry}set geometry(r){this._geometry=r,r&&this.initFormWithGeometry(r)}initFormWithGeometry(r){this.geometryForm.patchValue({name:r.name,type:r.type,isPublic:r.isPublic}),this.thumbnailPreview=r.thumbnailUrl||null}onGeometryFileSelected(r){const g=r.target;if(!g.files?.length)return;const d=g.files[0];return"obj"!==d.name.split(".").pop()?.toLowerCase()?(this.toastr.error("Only .obj files are allowed for room geometry"),void(g.value="")):d.size>26214400?(this.toastr.error("File size exceeds 25MB limit"),void(g.value="")):void(this.geometryFile=d)}onThumbnailFileSelected(r){const g=r.target;if(!g.files?.length)return;const d=g.files[0],C=d.name.split(".").pop()?.toLowerCase(),i=["jpg","jpeg","png"];if(!C||!i.includes(C))return this.toastr.error(`Invalid thumbnail format. Supported formats: ${i.join(", ")}`),void(g.value="");if(d.size>5242880)return this.toastr.error("Thumbnail size exceeds 5MB limit"),void(g.value="");this.thumbnailFile=d;const f=new FileReader;f.onload=()=>{this.thumbnailPreview=f.result},f.readAsDataURL(d)}save(){if(this.geometryForm.invalid)return this.geometryForm.markAllAsTouched(),void this.toastr.error("Please correct the form errors");this.geometry||this.geometryFile?this.modal.close({formValues:this.geometryForm.getRawValue(),geometryFile:this.geometryFile,thumbnailFile:this.thumbnailFile}):this.toastr.error("Please select a geometry file (.obj)")}static{this.\u0275fac=function(g){return new(g||s)}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["app-room-geometry-modal"]],standalone:!0,features:[t.aNF],decls:44,vars:9,consts:[[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],[1,"mb-4"],[1,"mb-3"],[1,"form-label",3,"for"],[1,"form-select",3,"id","formControlName"],[3,"value"],["for","geometryFile",1,"form-label"],[1,"text-danger"],["type","file","id","geometryFile","accept",".obj",1,"form-control",3,"change"],[1,"text-muted"],["for","thumbnailFile",1,"form-label"],["type","file","id","thumbnailFile","accept","image/png,image/jpeg",1,"form-control",3,"change"],[1,"mt-2"],[1,"form-check","mb-2"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[1,"form-control",3,"type","id","formControlName","placeholder"],[1,"text-danger","small","mt-1"],["alt","Thumbnail preview",1,"img-thumbnail",2,"max-width","200px","max-height","200px",3,"src"],["type","checkbox",1,"form-check-input",3,"id","formControlName"],[1,"form-check-label",3,"for"]],template:function(g,d){1&g&&(t.j41(0,"div",0)(1,"h4",1),t.EFF(2),t.k0s(),t.j41(3,"button",2),t.bIt("click",function(){return d.modal.dismiss()}),t.k0s()(),t.j41(4,"div",3)(5,"form",4)(6,"div",5)(7,"h5"),t.EFF(8,"Basic Information"),t.k0s(),t.Z7z(9,B,5,7,"div",6,_),t.k0s(),t.j41(11,"div",5)(12,"label",7),t.EFF(13),t.k0s(),t.j41(14,"select",8),t.Z7z(15,u,2,2,"option",9,_),t.k0s()(),t.j41(17,"div",5)(18,"h5"),t.EFF(19,"Files"),t.k0s(),t.j41(20,"div",6)(21,"label",10),t.EFF(22," Geometry File (.obj) "),t.DNE(23,v,2,0,"span",11),t.k0s(),t.j41(24,"input",12),t.bIt("change",function(i){return d.onGeometryFileSelected(i)}),t.k0s(),t.j41(25,"small",13),t.EFF(26,"Only .obj format, max 25MB"),t.k0s()(),t.j41(27,"div",6)(28,"label",14),t.EFF(29,"Thumbnail Image (Optional)"),t.k0s(),t.j41(30,"input",15),t.bIt("change",function(i){return d.onThumbnailFileSelected(i)}),t.k0s(),t.j41(31,"small",13),t.EFF(32,"PNG or JPG, max 5MB"),t.k0s(),t.DNE(33,G,2,1,"div",16),t.k0s()(),t.j41(34,"div",5)(35,"h5"),t.EFF(36,"Options"),t.k0s(),t.Z7z(37,j,4,4,"div",17,_),t.k0s()()(),t.j41(39,"div",18)(40,"button",19),t.bIt("click",function(){return d.modal.dismiss()}),t.EFF(41,"Cancel"),t.k0s(),t.j41(42,"button",20),t.bIt("click",function(){return d.save()}),t.EFF(43),t.k0s()()),2&g&&(t.R7$(2),t.SpI("",d.geometry?"Edit":"Upload"," Room Geometry"),t.R7$(3),t.Y8G("formGroup",d.geometryForm),t.R7$(4),t.Dyx(d.basicInfoFields),t.R7$(3),t.Y8G("for",d.typeField.id),t.R7$(),t.JRh(d.typeField.label),t.R7$(),t.Y8G("id",d.typeField.id)("formControlName",d.typeField.name),t.R7$(),t.Dyx(d.typeField.options),t.R7$(8),t.vxM(23,d.geometry?-1:23),t.R7$(10),t.vxM(33,d.thumbnailPreview?33:-1),t.R7$(4),t.Dyx(d.optionFields),t.R7$(6),t.SpI(" ",d.geometry?"Update":"Upload"," "))},dependencies:[e.X1,e.qT,e.xH,e.y7,e.me,e.Zm,e.wz,e.BC,e.cb,e.j4,e.JD,l.MD],styles:["h5[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#333;margin-bottom:1rem;padding-bottom:.5rem;border-bottom:1px solid #e0e0e0}.form-label[_ngcontent-%COMP%]{font-weight:500;margin-bottom:.5rem}.text-danger[_ngcontent-%COMP%]{font-size:.875rem}.img-thumbnail[_ngcontent-%COMP%]{border-radius:8px}"]})}}return s})()},8194:(U,$,p)=>{p.d($,{M:()=>g});var t=p(4438),e=p(9417),l=p(177),T=p(5794),h=p(4221),A=p(5135),_=p(3841);const R=(d,C)=>C.id;function S(d,C){if(1&d&&(t.j41(0,"option",15),t.EFF(1),t.k0s()),2&d){const i=C.$implicit;t.Y8G("value",i.id),t.R7$(),t.JRh(i.name)}}function b(d,C){if(1&d&&(t.j41(0,"option",15),t.EFF(1),t.k0s()),2&d){const i=C.$implicit;t.Y8G("value",i.id),t.R7$(),t.JRh(i.name)}}function B(d,C){if(1&d&&(t.j41(0,"option",15),t.EFF(1),t.k0s()),2&d){const i=C.$implicit;t.Y8G("value",i.id),t.R7$(),t.JRh(i.name)}}function u(d,C){if(1&d){const i=t.RV6();t.j41(0,"div",36)(1,"div",21)(2,"input",33),t.bIt("change",function(){const k=t.eBV(i).$implicit,x=t.XpG(4);return t.Njj(x.toggleArtwork(k.id))}),t.k0s(),t.j41(3,"label",37),t.EFF(4),t.k0s()()()}if(2&d){const i=C.$implicit,f=t.XpG(4);t.R7$(2),t.Y8G("id","artwork-"+i.id)("checked",f.selectedArtworks.includes(i.id)),t.R7$(),t.Y8G("for","artwork-"+i.id),t.R7$(),t.SpI(" ",i.title," ")}}function v(d,C){if(1&d&&(t.j41(0,"div",35)(1,"h6"),t.EFF(2,"Artworks in this series:"),t.k0s(),t.j41(3,"div",10),t.Z7z(4,u,5,4,"div",36,R),t.k0s()()),2&d){const i=t.XpG().$implicit,f=t.XpG(2);t.R7$(4),t.Dyx(f.getArtworksForSeries(i.id))}}function G(d,C){if(1&d){const i=t.RV6();t.j41(0,"div",32)(1,"div",21)(2,"input",33),t.bIt("change",function(){const k=t.eBV(i).$implicit,x=t.XpG(2);return t.Njj(x.toggleSeries(k.id))}),t.k0s(),t.j41(3,"label",34),t.EFF(4),t.k0s()(),t.DNE(5,v,6,0,"div",35),t.k0s()}if(2&d){const i=C.$implicit,f=t.XpG(2);t.R7$(2),t.Y8G("id","series-"+i.id)("checked",f.selectedSeries.includes(i.id)),t.R7$(),t.Y8G("for","series-"+i.id),t.R7$(),t.SpI(" ",i.label," "),t.R7$(),t.vxM(5,f.selectedSeries.includes(i.id)?5:-1)}}function j(d,C){if(1&d&&(t.j41(0,"div",28),t.Z7z(1,G,6,5,"div",32,R),t.k0s()),2&d){const i=t.XpG();t.R7$(),t.Dyx(i.seriesOptions)}}function P(d,C){1&d&&(t.j41(0,"p",38),t.EFF(1,"No series available. Please create series and artworks first."),t.k0s())}function s(d,C){if(1&d){const i=t.RV6();t.j41(0,"div",32)(1,"div",21)(2,"input",33),t.bIt("change",function(){const k=t.eBV(i).$implicit,x=t.XpG(2);return t.Njj(x.toggleThreeDObject(k.id))}),t.k0s(),t.j41(3,"label",34),t.EFF(4),t.k0s()()()}if(2&d){const i=C.$implicit,f=t.XpG(2);t.R7$(2),t.Y8G("id","object-"+i.id)("checked",f.selectedThreeDObjects.includes(i.id)),t.R7$(),t.Y8G("for","object-"+i.id),t.R7$(),t.SpI(" ",i.label," ")}}function F(d,C){if(1&d&&(t.j41(0,"div",28),t.Z7z(1,s,5,4,"div",32,R),t.k0s()),2&d){const i=t.XpG();t.R7$(),t.Dyx(i.threeDObjectOptions)}}function r(d,C){1&d&&(t.j41(0,"p",38),t.EFF(1,"No 3D objects available. Please create some 3D objects first."),t.k0s())}let g=(()=>{class d{constructor(){this.toastr=(0,t.WQX)(T.tw),this.store=(0,t.WQX)(_.P),this.modal=(0,t.WQX)(h.Lw),this._config=null,this._hydraScriptOptions=[],this._seriesOptions=[],this._threeDObjectOptions=[],this._textureOptions={floor:[],wall:[],ceiling:[],sky:[]},this._roomGeometryOptions={floor:[],walls:[],ceiling:[]},this.selectedArtworks=[],this.selectedSeries=[],this.selectedThreeDObjects=[],this.formVrConfig=new e.gE({title:new e.MJ("",{validators:[e.k0.required,e.k0.maxLength(100)],nonNullable:!0}),ceilingTextureRepeat:new e.MJ(1,{validators:[e.k0.required,e.k0.min(.1),e.k0.max(10)],nonNullable:!0}),wallTextureRepeat:new e.MJ(1,{validators:[e.k0.required,e.k0.min(.1),e.k0.max(10)],nonNullable:!0}),skyTextureRepeat:new e.MJ(1,{validators:[e.k0.required,e.k0.min(.1),e.k0.max(10)],nonNullable:!0}),floorTextureRepeat:new e.MJ(1,{validators:[e.k0.required,e.k0.min(.1),e.k0.max(10)],nonNullable:!0}),floorTextureId:new e.MJ(""),wallTextureId:new e.MJ(""),ceilingTextureId:new e.MJ(""),skyTextureId:new e.MJ(""),flyAllowed:new e.MJ(!1,{nonNullable:!0}),randomAllowed:new e.MJ(!1,{nonNullable:!0}),networked:new e.MJ(!1,{nonNullable:!0}),hydraScriptId:new e.MJ(""),floorGeometryId:new e.MJ(""),wallsGeometryId:new e.MJ(""),ceilingGeometryId:new e.MJ("")}),this.fields={basicInfo:[{formControl:this.formVrConfig.controls.title,id:"title",label:"Configuration Title",name:"title",type:"text",placeholder:"Enter a name for this VR configuration",errors:{required:"Title is required",maxlength:"Title cannot exceed 100 characters"}},{formControl:this.formVrConfig.controls.hydraScriptId,id:"hydraScriptId",label:"Hydra Script",name:"hydraScriptId",type:"select",options:[],placeholder:"Select a Hydra script"}],textureSettings:[{formControl:this.formVrConfig.controls.floorTextureId,id:"floorTextureId",label:"Floor Texture",name:"floorTextureId",type:"select",options:[],placeholder:"Select a floor texture"},{formControl:this.formVrConfig.controls.floorTextureRepeat,id:"floorTextureRepeat",label:"Floor Texture Repeat",name:"floorTextureRepeat",type:"number",placeholder:"1.0",errors:{required:"Repeat value is required",min:"Minimum value is 0.1",max:"Maximum value is 10"}},{formControl:this.formVrConfig.controls.wallTextureId,id:"wallTextureId",label:"Wall Texture",name:"wallTextureId",type:"select",options:[],placeholder:"Select a wall texture"},{formControl:this.formVrConfig.controls.wallTextureRepeat,id:"wallTextureRepeat",label:"Wall Texture Repeat",name:"wallTextureRepeat",type:"number",placeholder:"1.0",errors:{required:"Repeat value is required",min:"Minimum value is 0.1",max:"Maximum value is 10"}},{formControl:this.formVrConfig.controls.ceilingTextureId,id:"ceilingTextureId",label:"Ceiling Texture",name:"ceilingTextureId",type:"select",options:[],placeholder:"Select a ceiling texture"},{formControl:this.formVrConfig.controls.ceilingTextureRepeat,id:"ceilingTextureRepeat",label:"Ceiling Texture Repeat",name:"ceilingTextureRepeat",type:"number",placeholder:"1.0",errors:{required:"Repeat value is required",min:"Minimum value is 0.1",max:"Maximum value is 10"}},{formControl:this.formVrConfig.controls.skyTextureId,id:"skyTextureId",label:"Sky Texture",name:"skyTextureId",type:"select",options:[],placeholder:"Select a sky texture"},{formControl:this.formVrConfig.controls.skyTextureRepeat,id:"skyTextureRepeat",label:"Sky Texture Repeat",name:"skyTextureRepeat",type:"number",placeholder:"1.0",errors:{required:"Repeat value is required",min:"Minimum value is 0.1",max:"Maximum value is 10"}}],options:[{formControl:this.formVrConfig.controls.flyAllowed,id:"flyAllowed",label:"Enable Flying",name:"flyAllowed",type:"checkbox"},{formControl:this.formVrConfig.controls.randomAllowed,id:"randomAllowed",label:"Allow Random Placement",name:"randomAllowed",type:"checkbox"},{formControl:this.formVrConfig.controls.networked,id:"networked",label:"Enable Multi-User (Networked)",name:"networked",type:"checkbox"}]}}get config(){return this._config}set config(i){this._config=i,i&&this.initFormWithConfig(i)}get seriesOptions(){return this._seriesOptions}set seriesOptions(i){this._seriesOptions=i}get textureOptions(){return this._textureOptions}set textureOptions(i){this._textureOptions=i}get hydraScriptOptions(){return this._hydraScriptOptions}set hydraScriptOptions(i){this._hydraScriptOptions=i}get threeDObjectOptions(){return this._threeDObjectOptions}set threeDObjectOptions(i){this._threeDObjectOptions=i}get roomGeometryOptions(){return this._roomGeometryOptions}set roomGeometryOptions(i){this._roomGeometryOptions=i,this.updateRoomGeometryOptions()}ngOnInit(){this.updateTextureOptions(),this.updateHydraScriptOptions(),this.updateRoomGeometryOptions(),this.config&&this.loadSelectedItems()}updateRoomGeometryOptions(){}updateTextureOptions(){this.fields.textureSettings[0].options=[{id:"",label:"None"},...this.textureOptions.floor.map(O=>({id:O.id,label:O.filename}))],this.fields.textureSettings[2].options=[{id:"",label:"None"},...this.textureOptions.wall.map(O=>({id:O.id,label:O.filename}))],this.fields.textureSettings[4].options=[{id:"",label:"None"},...this.textureOptions.ceiling.map(O=>({id:O.id,label:O.filename}))],this.fields.textureSettings[6].options=[{id:"",label:"None"},...this.textureOptions.sky.map(O=>({id:O.id,label:O.filename}))]}initFormWithConfig(i){this.formVrConfig.patchValue({title:i.title,ceilingTextureRepeat:i.ceilingTextureRepeat,wallTextureRepeat:i.wallTextureRepeat,skyTextureRepeat:i.skyTextureRepeat,floorTextureRepeat:i.floorTextureRepeat,flyAllowed:!!i.flyAllowed,randomAllowed:!!i.randomAllowed,networked:!!i.networked,floorTextureId:i.floorTextureId||"",wallTextureId:i.wallTextureId||"",ceilingTextureId:i.ceilingTextureId||"",skyTextureId:i.skyTextureId||"",hydraScriptId:i.hydraScriptId||"",floorGeometryId:i.floorGeometry?.id||"",wallsGeometryId:i.wallsGeometry?.id||"",ceilingGeometryId:i.ceilingGeometry?.id||""})}loadSelectedItems(){this.config?.artworks&&(this.selectedArtworks=this.config.artworks.map(i=>i.id)),this.config?.series&&(this.selectedSeries=this.config.series.map(i=>i.id)),this.config?.threeDObjects&&(this.selectedThreeDObjects=this.config.threeDObjects.map(i=>i.id))}toggleSeries(i){const f=this.selectedSeries.indexOf(i);if(-1===f)this.selectedSeries.push(i);else{this.selectedSeries.splice(f,1);const k=this.getArtworksForSeries(i).map(x=>x.id);this.selectedArtworks=this.selectedArtworks.filter(x=>!k.includes(x))}}toggleArtwork(i){const f=this.selectedArtworks.indexOf(i);-1===f?this.selectedArtworks.push(i):this.selectedArtworks.splice(f,1)}toggleThreeDObject(i){const f=this.selectedThreeDObjects.indexOf(i);-1===f?this.selectedThreeDObjects.push(i):this.selectedThreeDObjects.splice(f,1)}getArtworksForSeries(i){return this.store.artworks().filter(f=>f.seriesId===i)}updateHydraScriptOptions(){const i=this.fields.basicInfo.find(f=>"hydraScriptId"===f.id);i&&(i.options=[{id:"",label:"None"},...this.hydraScriptOptions])}saveConfiguration(){if(!this.formVrConfig.valid)return this.formVrConfig.markAllAsTouched(),void this.toastr.error("Please correct the errors in the form");const i=this.formVrConfig.getRawValue(),f=this.config?.artworkTransforms||{},k={};this.selectedArtworks.forEach(O=>{f[O]&&(k[O]=f[O])});const x={...i,flyAllowed:!!i.flyAllowed,randomAllowed:!!i.randomAllowed,networked:!!i.networked,artworkIds:this.selectedArtworks,seriesIds:this.selectedSeries,threeDObjectIds:this.selectedThreeDObjects,artworkTransforms:k};console.log("\u{1f4be} Saving VR Config with data:",x),console.log("\u{1f4e6} Geometry IDs:",{floor:x.floorGeometryId,walls:x.wallsGeometryId,ceiling:x.ceilingGeometryId}),this.modal.close(x)}static{this.\u0275fac=function(f){return new(f||d)}}static{this.\u0275cmp=t.VBU({type:d,selectors:[["app-vr-base-config-modal"]],standalone:!0,features:[t.aNF],decls:72,vars:12,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],[3,"formGroup","fields","title"],[3,"formGroup","fields","title","columns"],[1,"mb-4"],[1,"mb-3"],[1,"text-muted","small"],[1,"row"],[1,"col-md-4","mb-3"],["for","floorGeometryId",1,"form-label"],["id","floorGeometryId","formControlName","floorGeometryId",1,"form-select"],["value",""],[3,"value"],["for","wallsGeometryId",1,"form-label"],["id","wallsGeometryId","formControlName","wallsGeometryId",1,"form-select"],["for","ceilingGeometryId",1,"form-label"],["id","ceilingGeometryId","formControlName","ceilingGeometryId",1,"form-select"],[1,"col-md-6","mb-3"],[1,"form-check"],["type","checkbox","id","flyAllowed","formControlName","flyAllowed",1,"form-check-input"],["for","flyAllowed",1,"form-check-label"],["type","checkbox","id","randomAllowed","formControlName","randomAllowed",1,"form-check-input"],["for","randomAllowed",1,"form-check-label"],["type","checkbox","id","networked","formControlName","networked",1,"form-check-input"],["for","networked",1,"form-check-label"],[1,"list-group"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[1,"list-group-item"],["type","checkbox",1,"form-check-input",3,"change","id","checked"],[1,"form-check-label",3,"for"],[1,"mt-3","ms-4"],[1,"col-md-4","mb-2"],[1,"form-check-label","text-truncate",3,"for"],[1,"text-muted"]],template:function(f,k){1&f&&(t.j41(0,"div",0)(1,"h5",1),t.EFF(2),t.k0s(),t.j41(3,"button",2),t.bIt("click",function(){return k.modal.dismiss()}),t.k0s()(),t.j41(4,"div",3)(5,"form",4),t.nrm(6,"app-artwork-fieldset",5)(7,"app-artwork-fieldset",6),t.j41(8,"div",7)(9,"h5",8),t.EFF(10,"Room Geometry (Optional)"),t.k0s(),t.j41(11,"p",9),t.EFF(12,"Select custom 3D geometry for floor, walls, and ceiling. Leave empty for default environment."),t.k0s(),t.j41(13,"div",10)(14,"div",11)(15,"label",12),t.EFF(16,"Floor Geometry"),t.k0s(),t.j41(17,"select",13)(18,"option",14),t.EFF(19,"No custom floor"),t.k0s(),t.Z7z(20,S,2,2,"option",15,R),t.k0s()(),t.j41(22,"div",11)(23,"label",16),t.EFF(24,"Walls Geometry"),t.k0s(),t.j41(25,"select",17)(26,"option",14),t.EFF(27,"No custom walls"),t.k0s(),t.Z7z(28,b,2,2,"option",15,R),t.k0s()(),t.j41(30,"div",11)(31,"label",18),t.EFF(32,"Ceiling Geometry"),t.k0s(),t.j41(33,"select",19)(34,"option",14),t.EFF(35,"No custom ceiling"),t.k0s(),t.Z7z(36,B,2,2,"option",15,R),t.k0s()()()(),t.j41(38,"div",7)(39,"h5",8),t.EFF(40,"Options"),t.k0s(),t.j41(41,"div",10)(42,"div",20)(43,"div",21),t.nrm(44,"input",22),t.j41(45,"label",23),t.EFF(46,"Enable Flying"),t.k0s()()(),t.j41(47,"div",20)(48,"div",21),t.nrm(49,"input",24),t.j41(50,"label",25),t.EFF(51,"Allow Random Placement"),t.k0s()()(),t.j41(52,"div",20)(53,"div",21),t.nrm(54,"input",26),t.j41(55,"label",27),t.EFF(56,"Enable Multi-User (Networked)"),t.k0s()()()()(),t.j41(57,"div",7)(58,"h5",8),t.EFF(59,"Select Series"),t.k0s(),t.DNE(60,j,3,0,"div",28)(61,P,2,0),t.k0s(),t.j41(62,"div",7)(63,"h5",8),t.EFF(64,"Select 3D Objects"),t.k0s(),t.DNE(65,F,3,0,"div",28)(66,r,2,0),t.k0s()()(),t.j41(67,"div",29)(68,"button",30),t.bIt("click",function(){return k.modal.dismiss()}),t.EFF(69,"Cancel"),t.k0s(),t.j41(70,"button",31),t.bIt("click",function(){return k.saveConfiguration()}),t.EFF(71),t.k0s()()),2&f&&(t.R7$(2),t.JRh(k.config?"Edit VR Configuration":"Create VR Configuration"),t.R7$(3),t.Y8G("formGroup",k.formVrConfig),t.R7$(),t.Y8G("formGroup",k.formVrConfig)("fields",k.fields.basicInfo)("title","Configuration Details"),t.R7$(),t.Y8G("formGroup",k.formVrConfig)("fields",k.fields.textureSettings)("title","Texture Settings")("columns",2),t.R7$(13),t.Dyx(k.roomGeometryOptions.floor),t.R7$(8),t.Dyx(k.roomGeometryOptions.walls),t.R7$(8),t.Dyx(k.roomGeometryOptions.ceiling),t.R7$(24),t.vxM(60,k.seriesOptions.length>0?60:61),t.R7$(5),t.vxM(65,k.threeDObjectOptions.length>0?65:66),t.R7$(6),t.SpI(" ",k.config?"Update Configuration":"Create Configuration"," "))},dependencies:[e.X1,e.qT,e.xH,e.y7,e.Zm,e.wz,e.BC,e.cb,e.j4,e.JD,l.MD,A.G]})}}return d})()},1367:(U,$,p)=>{p.d($,{H2:()=>t.H,GF:()=>T,Ap:()=>e,ex:()=>l});var t=p(6447),e=function(h){return h.FLOOR="floor",h.WALL="wall",h.SKY="sky",h.CEILING="ceiling",h}(e||{}),l=function(h){return h.MESH="mesh",h.POINT_CLOUD="pointCloud",h}(l||{}),T=function(h){return h.FLOOR="floor",h.WALLS="walls",h.CEILING="ceiling",h}(T||{})},2010:(U,$,p)=>{p.d($,{v:()=>T});var t=p(5312),e=p(4438),l=p(1626);let T=(()=>{class h{constructor(_){this.http=_,this.apiUrl=t.c.apiUrl}findAll(_){return this.http.get(`${this.apiUrl}/${this.endpoint}`,{params:{..._}})}findOne(_){return this.http.get(`${this.apiUrl}/${this.endpoint}/${_}`)}create(_){return this.http.post(`${this.apiUrl}/${this.endpoint}`,_)}update(_,R){return this.http.patch(`${this.apiUrl}/${this.endpoint}/${_}`,R)}remove(_){return this.http.delete(`${this.apiUrl}/${this.endpoint}/${_}`)}static{this.\u0275fac=function(R){return new(R||h)(e.KVO(l.Qq))}}static{this.\u0275prov=e.jDH({token:h,factory:h.\u0275fac})}}return h})()},2249:(U,$,p)=>{p.d($,{f:()=>T});var t=p(2010),e=p(4438),l=p(1626);let T=(()=>{class h extends t.v{constructor(_){super(_),this.http=_,this.endpoint="hydra-scripts"}getMyScripts(_){return this.http.get(`${this.apiUrl}/${this.endpoint}/my-scripts`,{params:{..._}})}getHydraScript(_){return this.http.get(`${this.apiUrl}/${this.endpoint}/${_}`)}static{this.\u0275fac=function(R){return new(R||h)(e.KVO(l.Qq))}}static{this.\u0275prov=e.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}}return h})()},3373:(U,$,p)=>{p.d($,{gA:()=>T,vA:()=>t.v,AF:()=>_,fC:()=>S.f,UN:()=>h,xB:()=>A,RV:()=>R});var t=p(2010),e=p(4438),l=p(1626);let T=(()=>{class b extends t.v{constructor(u){super(u),this.http=u,this.endpoint="artist-profiles"}getMyProfile(){return this.http.get(`${this.apiUrl}/${this.endpoint}/my-profile`)}publishArtistSite(u){return this.http.post(`${this.apiUrl}/${this.endpoint}/${u}/publish`,{})}static{this.\u0275fac=function(v){return new(v||b)(e.KVO(l.Qq))}}static{this.\u0275prov=e.jDH({token:b,factory:b.\u0275fac,providedIn:"root"})}}return b})(),h=(()=>{class b extends t.v{constructor(u){super(u),this.http=u,this.endpoint="kwalhia-art"}getAllArtworks(u){return this.findAll(u)}getMyArtworks(u){return this.http.get(`${this.apiUrl}/${this.endpoint}/my-artwork`,{params:{...u}})}getArtwork(u){return this.findOne(u)}uploadArtwork(u,v,G){const j=new FormData;return j.append("file",v),j.append("aspectRatio",G),Object.entries(u).forEach(([P,s])=>{null!=s&&j.append(P,s.toString())}),this.http.post(`${this.apiUrl}/${this.endpoint}`,j)}updateArtwork(u,v,G){const j=new FormData;return G&&j.append("file",G),Object.entries(v).forEach(([P,s])=>{null!=s&&j.append(P,s.toString())}),this.http.patch(`${this.apiUrl}/${this.endpoint}/${u}`,j)}uploadWithFormData(u){return this.http.post(`${this.apiUrl}/${this.endpoint}`,u)}deleteArtwork(u){return this.remove(u)}create(u){return console.warn("Please use uploadArtwork method instead of create for adding new artwork"),super.create(u)}static{this.\u0275fac=function(v){return new(v||b)(e.KVO(l.Qq))}}static{this.\u0275prov=e.jDH({token:b,factory:b.\u0275fac,providedIn:"root"})}}return b})(),A=(()=>{class b extends t.v{constructor(u){super(u),this.http=u,this.endpoint="series"}getMySeries(u){return this.http.get(`${this.apiUrl}/${this.endpoint}/my-series`,{params:{...u}})}static{this.\u0275fac=function(v){return new(v||b)(e.KVO(l.Qq))}}static{this.\u0275prov=e.jDH({token:b,factory:b.\u0275fac,providedIn:"root"})}}return b})(),_=(()=>{class b extends t.v{constructor(u){super(u),this.http=u,this.endpoint="galleries"}getMyGallery(){return this.http.get(`${this.apiUrl}/${this.endpoint}/my-gallery`)}static{this.\u0275fac=function(v){return new(v||b)(e.KVO(l.Qq))}}static{this.\u0275prov=e.jDH({token:b,factory:b.\u0275fac,providedIn:"root"})}}return b})(),R=(()=>{class b extends t.v{constructor(u){super(u),this.http=u,this.endpoint="textures"}getTexture(u){return this.http.get(`${this.apiUrl}/${this.endpoint}/${u}`)}getMyTextures(u){return this.http.get(`${this.apiUrl}/${this.endpoint}/my-textures`,{params:{...u}})}getTexturesByType(u,v){return this.http.get(`${this.apiUrl}/${this.endpoint}/type/${u}`,{params:{...v}})}uploadTexture(u,v,G=!1){const j=new FormData;return j.append("file",v),j.append("type",u),j.append("isPublic",G.toString()),this.http.post(`${this.apiUrl}/${this.endpoint}`,j)}static{this.\u0275fac=function(v){return new(v||b)(e.KVO(l.Qq))}}static{this.\u0275prov=e.jDH({token:b,factory:b.\u0275fac,providedIn:"root"})}}return b})();var S=p(2249)},7533:(U,$,p)=>{function t(e){if(!e)return!1;const l=e.toLowerCase();return l.endsWith(".mp4")||l.endsWith(".webm")||l.includes("video/")}p.d($,{A:()=>t})}}]);