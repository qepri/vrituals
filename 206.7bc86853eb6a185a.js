"use strict";(self.webpackChunkfront_simple=self.webpackChunkfront_simple||[]).push([[206],{2206:(ie,x,l)=>{l.r(x),l.d(x,{default:()=>te});var t=l(4438),f=l(177),c=l(9417),g=l(3841),u=l(4221),v=l(5794),j=l(7023),C=l(3373),p=l(1367),P=l(8194),d=l(980),T=l(2010),k=l(1626);let R=(()=>{class i extends T.v{constructor(e){super(e),this.http=e,this.endpoint="room-geometries"}getMyGeometries(e){return this.http.get(`${this.apiUrl}/${this.endpoint}/my-geometries`,{params:{...e}})}upload(e){return this.http.post(`${this.apiUrl}/${this.endpoint}`,e)}updateWithFiles(e,n){return this.http.patch(`${this.apiUrl}/${this.endpoint}/${e}`,n)}static{this.\u0275fac=function(n){return new(n||i)(t.KVO(k.Qq))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var S=l(1774),E=l(8590);const D=(i,r)=>r.id;function V(i,r){1&i&&(t.j41(0,"div",7)(1,"strong"),t.EFF(2,"Curator Mode:"),t.k0s(),t.EFF(3," As a curator, you can include artworks and series from other artists. "),t.k0s())}function I(i,r){if(1&i&&t.DNE(0,V,4,0,"div",7),2&i){const e=t.XpG();t.vxM(0,e.isCurator()?0:-1)}}function N(i,r){1&i&&(t.j41(0,"div",5)(1,"div",8)(2,"span",9),t.EFF(3,"Loading..."),t.k0s()()())}function w(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",10)(1,"div",11)(2,"div",12)(3,"h5",13),t.EFF(4),t.k0s(),t.j41(5,"small",14),t.EFF(6),t.nI1(7,"date"),t.k0s()(),t.j41(8,"div",15)(9,"div",16)(10,"span",17),t.EFF(11),t.k0s(),t.j41(12,"span",17),t.EFF(13),t.k0s(),t.j41(14,"span",17),t.EFF(15),t.k0s(),t.j41(16,"span",18),t.EFF(17),t.k0s()(),t.j41(18,"div",16)(19,"span",19),t.EFF(20),t.k0s()(),t.j41(21,"div",20)(22,"span",21),t.EFF(23),t.k0s(),t.j41(24,"span",22),t.EFF(25),t.k0s()()(),t.j41(26,"div",23)(27,"div",24)(28,"div",25)(29,"button",26),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.previewVrGallery(o))}),t.nrm(30,"i",27),t.EFF(31," Preview "),t.k0s()(),t.j41(32,"div",25)(33,"button",28),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.openConfigModal(o))}),t.nrm(34,"i",29),t.EFF(35," Edit "),t.k0s()()(),t.j41(36,"div",30)(37,"div",25)(38,"button",31),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.publishVrConfig(o))}),t.nrm(39,"i",32),t.EFF(40," Publish "),t.k0s()(),t.j41(41,"div",25)(42,"button",33),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.deleteConfig(o.id))}),t.nrm(43,"i",34),t.EFF(44," Delete "),t.k0s()()()()()()}if(2&i){const e=r.$implicit,n=t.XpG(2);t.R7$(4),t.JRh(e.title),t.R7$(2),t.SpI("Created: ",t.bMT(7,15,e.createdAt),""),t.R7$(5),t.SpI("Ceiling Repeat: ",e.ceilingTextureRepeat,""),t.R7$(2),t.SpI("Wall Repeat: ",e.wallTextureRepeat,""),t.R7$(2),t.SpI("Floor Repeat: ",e.floorTextureRepeat,""),t.R7$(2),t.SpI("Sky Repeat: ",e.skyTextureRepeat,""),t.R7$(3),t.Lme(" 3d Assets: ",(null==e.threeDObjects?null:e.threeDObjects.length)||0," object",1!==((null==e.threeDObjects?null:e.threeDObjects.length)||0)?"s":"",""),t.R7$(2),t.AVh("bg-success",e.flyAllowed),t.R7$(),t.SpI(" Flight: ",e.flyAllowed?"Enabled":"Disabled"," "),t.R7$(),t.AVh("bg-success",e.randomAllowed),t.R7$(),t.SpI(" Random: ",e.randomAllowed?"Enabled":"Disabled"," "),t.R7$(13),t.Y8G("disabled",n.loading())}}function X(i,r){if(1&i&&(t.j41(0,"div",6),t.Z7z(1,w,45,17,"div",10,D),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.vrConfigs)}}function A(i,r){1&i&&(t.j41(0,"div",35)(1,"p",36),t.EFF(2,"You haven't created any VR configurations yet. Create your first one to get started!"),t.k0s()())}let U=(()=>{class i{constructor(){this.store=(0,t.WQX)(g.P),this.vrConfigService=(0,t.WQX)(j.$),this.roomGeometryService=(0,t.WQX)(R),this.toastr=(0,t.WQX)(v.tw),this.modalService=(0,t.WQX)(u.Bq),this.loading=(0,t.vPA)(!1),this.profileLoaded=(0,t.EWP)(()=>!!this.store.artistProfile()),this.isCurator=(0,t.EWP)(()=>this.store.artistProfile()?.isCurator||!1)}get vrConfigs(){return this.store.vrConfigs()}get series(){return this.store.series()}get textures(){return this.store.textures()}get roomGeometries(){return this.store.roomGeometries()}ngOnInit(){0===this.vrConfigs.length&&this.loadConfigs(),0===this.roomGeometries.length&&this.loadRoomGeometries()}loadConfigs(){this.loading.set(!0),this.vrConfigService.getMyConfigs({page:1,limit:50}).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:e=>{this.store.vrConfigs.set(e.data)},error:()=>this.toastr.error("Failed to load VR configurations")})}loadRoomGeometries(){this.roomGeometryService.getMyGeometries({page:1,limit:100}).subscribe({next:e=>{this.store.roomGeometries.set(e.data)},error:()=>this.toastr.error("Failed to load room geometries")})}openConfigModal(e){const n=this.modalService.open(P.M,{size:"lg",centered:!0,backdrop:"static",scrollable:!0});n.componentInstance.config=e||null,n.componentInstance.seriesOptions=this.series.map(a=>({id:a.id,label:a.title})),n.componentInstance.hydraScriptOptions=this.store.hydraScripts().map(a=>({id:a.id,label:a.title})),n.componentInstance.threeDObjectOptions=this.store.threeDObjects().map(a=>({id:a.id,label:a.title}));const o={floor:this.textures.filter(a=>a.type===p.Ap.FLOOR),wall:this.textures.filter(a=>a.type===p.Ap.WALL),ceiling:this.textures.filter(a=>a.type===p.Ap.CEILING),sky:this.textures.filter(a=>a.type===p.Ap.SKY)};n.componentInstance.textureOptions=o;const s={floor:this.roomGeometries.filter(a=>a.type===p.GF.FLOOR),walls:this.roomGeometries.filter(a=>a.type===p.GF.WALLS),ceiling:this.roomGeometries.filter(a=>a.type===p.GF.CEILING)};n.componentInstance.roomGeometryOptions=s,n.result.then(a=>{e?this.updateConfig(e.id,a):this.createConfig(a)},()=>{})}createConfig(e){this.loading.set(!0),this.vrConfigService.create(e).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:n=>{this.store.addVrConfig(n),this.toastr.success("VR configuration created successfully")},error:()=>this.toastr.error("Failed to create VR configuration")})}updateConfig(e,n){console.log("\u{1f504} Updating VR config",e,"with data:",n),this.loading.set(!0),this.vrConfigService.update(e,n).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:o=>{console.log("\u2705 VR config updated successfully:",o),this.store.updateVrConfig(o),this.toastr.success("VR configuration updated successfully")},error:o=>{console.error("\u274c Failed to update VR configuration:",o),this.toastr.error("Failed to update VR configuration")}})}deleteConfig(e){confirm("Are you sure you want to delete this configuration?")&&(this.loading.set(!0),this.vrConfigService.remove(e).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:()=>{this.store.removeVrConfig(e),this.toastr.success("VR configuration deleted successfully")},error:()=>this.toastr.error("Failed to delete VR configuration")}))}previewVrGallery(e){const n=this.store.artistProfile()?.displayName?.toLowerCase().replace(/\s+/g,"-");if(!n)return void this.toastr.error("Unable to open preview: Artist profile not found");let o;if(e.randomAllowed){const s={artworks:e.artworks?.map(m=>m.id)||[],transforms:e.artworkTransforms||{},timestamp:Date.now(),randomized:!0},a=(0,E.Jh)(s);o=`/${S.S.KWH}/${n}/vrGallery/preview/${e.id}/${a}`}else{const s={artworks:e.artworks?.map(m=>m.id)||[],transforms:e.artworkTransforms||{}},a=(0,E.Jh)(s);o=`/${S.S.KWH}/${n}/vrGallery/preview/${e.id}/${a}`}window.open(o,"_blank")}publishVrConfig(e){confirm(`Are you sure you want to publish "${e.title}"? This will make it live on the web.`)&&(this.loading.set(!0),this.vrConfigService.publishVrConfig(e.id).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:()=>{this.toastr.success("VR configuration published successfully")},error:()=>this.toastr.error("Failed to publish VR configuration")}))}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-vr-base-config"]],standalone:!0,features:[t.aNF],decls:12,vars:3,consts:[[1,"row","mb-4"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-plus"],[1,"d-flex","justify-content-center","mb-4"],[1,"list-group","mb-4"],[1,"alert","alert-info","mb-3"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"list-group-item"],[1,"row","align-items-center"],[1,"col-md-4"],[1,"mb-1"],[1,"text-muted"],[1,"col-md-5"],[1,"small","mb-1"],[1,"badge","bg-info","me-1"],[1,"badge","bg-info"],[1,"badge","bg-primary"],[1,"small"],[1,"badge","bg-secondary","me-1"],[1,"badge","bg-secondary"],[1,"col-md-3"],[1,"row","mb-2"],[1,"col-6"],[1,"btn","btn-sm","btn-success","w-100",3,"click"],[1,"fa","fa-eye"],[1,"btn","btn-sm","btn-primary","w-100",3,"click"],[1,"fa","fa-edit"],[1,"row"],[1,"btn","btn-sm","btn-info","w-100",3,"click","disabled"],[1,"fa","fa-globe"],[1,"btn","btn-sm","btn-danger","w-100",3,"click"],[1,"fa","fa-trash"],[1,"alert","alert-info"],[1,"mb-0"]],template:function(n,o){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),t.EFF(4,"VR Gallery Configurations"),t.k0s(),t.j41(5,"button",3),t.bIt("click",function(){return o.openConfigModal()}),t.nrm(6,"i",4),t.EFF(7," Create Configuration "),t.k0s()(),t.DNE(8,I,1,1)(9,N,4,0,"div",5)(10,X,3,0,"div",6)(11,A,3,0),t.k0s()()),2&n&&(t.R7$(8),t.vxM(8,o.profileLoaded()?8:-1),t.R7$(),t.vxM(9,o.loading()?9:-1),t.R7$(),t.vxM(10,o.vrConfigs.length>0?10:o.loading()?-1:11))},dependencies:[f.MD,f.vh,c.X1]})}}return i})();var F=l(190);const y=(i,r)=>r.id,B=(i,r,e,n)=>[i,r,e,n];function W(i,r){1&i&&(t.j41(0,"div",3)(1,"div",10)(2,"span",11),t.EFF(3,"Loading..."),t.k0s()()())}function L(i,r){if(1&i&&(t.j41(0,"span",13),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.JRh(e.floorTextures.length)}}function H(i,r){if(1&i&&(t.j41(0,"span",13),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.JRh(e.wallTextures.length)}}function Q(i,r){if(1&i&&(t.j41(0,"span",13),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.JRh(e.ceilingTextures.length)}}function z(i,r){if(1&i&&(t.j41(0,"span",13),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.JRh(e.skyTextures.length)}}function Y(i,r){if(1&i){const e=t.RV6();t.j41(0,"li",5)(1,"button",12),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.setActiveType(o))}),t.EFF(2),t.DNE(3,L,2,1)(4,H,2,1)(5,Q,2,1)(6,z,2,1),t.k0s()()}if(2&i){let e;const n=r.$implicit,o=t.XpG();t.R7$(),t.AVh("active",o.activeType()===n),t.R7$(),t.SpI(" ",n.charAt(0)+n.slice(1).toLowerCase()," "),t.R7$(),t.vxM(3,(e=n)===o.TextureType.FLOOR?3:e===o.TextureType.WALL?4:e===o.TextureType.CEILING?5:e===o.TextureType.SKY?6:-1)}}function J(i,r){1&i&&(t.j41(0,"div",1)(1,"div",14),t.EFF(2," No floor textures found. Upload some to get started. "),t.k0s()())}function Z(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",15)(1,"div",16),t.nrm(2,"img",17),t.j41(3,"div",18)(4,"h6",19),t.EFF(5),t.k0s(),t.j41(6,"div",20)(7,"span",21),t.EFF(8),t.k0s()(),t.j41(9,"div",22)(10,"button",23),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(4);return t.Njj(s.toggleTexturePublic(o))}),t.EFF(11),t.k0s(),t.j41(12,"button",24),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(4);return t.Njj(s.deleteTexture(o.id))}),t.nrm(13,"i",25),t.k0s()()()()()}if(2&i){const e=r.$implicit;t.R7$(2),t.Y8G("src",e.cdnUrl,t.B4B),t.R7$(3),t.JRh(e.filename),t.R7$(2),t.AVh("bg-success",e.isPublic)("bg-secondary",!e.isPublic),t.R7$(),t.SpI(" ",e.isPublic?"Public":"Private"," "),t.R7$(3),t.SpI(" ",e.isPublic?"Make Private":"Make Public"," ")}}function K(i,r){if(1&i&&t.Z7z(0,Z,14,8,"div",15,y),2&i){const e=t.XpG(3);t.Dyx(e.floorTextures)}}function q(i,r){if(1&i&&t.DNE(0,J,3,0,"div",1)(1,K,2,0),2&i){const e=t.XpG(2);t.vxM(0,0===e.floorTextures.length?0:1)}}function tt(i,r){1&i&&(t.j41(0,"div",1)(1,"div",14),t.EFF(2," No wall textures found. Upload some to get started. "),t.k0s()())}function et(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",15)(1,"div",16),t.nrm(2,"img",26),t.j41(3,"div",18)(4,"h6",19),t.EFF(5),t.k0s(),t.j41(6,"div",20)(7,"span",21),t.EFF(8),t.k0s()(),t.j41(9,"div",22)(10,"button",23),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(4);return t.Njj(s.toggleTexturePublic(o))}),t.EFF(11),t.k0s(),t.j41(12,"button",24),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(4);return t.Njj(s.deleteTexture(o.id))}),t.nrm(13,"i",25),t.k0s()()()()()}if(2&i){const e=r.$implicit;t.R7$(2),t.Y8G("src",e.cdnUrl,t.B4B),t.R7$(3),t.JRh(e.filename),t.R7$(2),t.AVh("bg-success",e.isPublic)("bg-secondary",!e.isPublic),t.R7$(),t.SpI(" ",e.isPublic?"Public":"Private"," "),t.R7$(3),t.SpI(" ",e.isPublic?"Make Private":"Make Public"," ")}}function it(i,r){if(1&i&&t.Z7z(0,et,14,8,"div",15,y),2&i){const e=t.XpG(3);t.Dyx(e.wallTextures)}}function ot(i,r){if(1&i&&t.DNE(0,tt,3,0,"div",1)(1,it,2,0),2&i){const e=t.XpG(2);t.vxM(0,0===e.wallTextures.length?0:1)}}function nt(i,r){1&i&&(t.j41(0,"div",1)(1,"div",14),t.EFF(2," No ceiling textures found. Upload some to get started. "),t.k0s()())}function rt(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",15)(1,"div",16),t.nrm(2,"img",27),t.j41(3,"div",18)(4,"h6",19),t.EFF(5),t.k0s(),t.j41(6,"div",20)(7,"span",21),t.EFF(8),t.k0s()(),t.j41(9,"div",22)(10,"button",23),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(4);return t.Njj(s.toggleTexturePublic(o))}),t.EFF(11),t.k0s(),t.j41(12,"button",24),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(4);return t.Njj(s.deleteTexture(o.id))}),t.nrm(13,"i",25),t.k0s()()()()()}if(2&i){const e=r.$implicit;t.R7$(2),t.Y8G("src",e.cdnUrl,t.B4B),t.R7$(3),t.JRh(e.filename),t.R7$(2),t.AVh("bg-success",e.isPublic)("bg-secondary",!e.isPublic),t.R7$(),t.SpI(" ",e.isPublic?"Public":"Private"," "),t.R7$(3),t.SpI(" ",e.isPublic?"Make Private":"Make Public"," ")}}function st(i,r){if(1&i&&t.Z7z(0,rt,14,8,"div",15,y),2&i){const e=t.XpG(3);t.Dyx(e.ceilingTextures)}}function at(i,r){if(1&i&&t.DNE(0,nt,3,0,"div",1)(1,st,2,0),2&i){const e=t.XpG(2);t.vxM(0,0===e.ceilingTextures.length?0:1)}}function lt(i,r){1&i&&(t.j41(0,"div",1)(1,"div",14),t.EFF(2," No sky textures found. Upload some to get started. "),t.k0s()())}function ct(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",15)(1,"div",16),t.nrm(2,"img",28),t.j41(3,"div",18)(4,"h6",19),t.EFF(5),t.k0s(),t.j41(6,"div",20)(7,"span",21),t.EFF(8),t.k0s()(),t.j41(9,"div",22)(10,"button",23),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(4);return t.Njj(s.toggleTexturePublic(o))}),t.EFF(11),t.k0s(),t.j41(12,"button",24),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(4);return t.Njj(s.deleteTexture(o.id))}),t.nrm(13,"i",25),t.k0s()()()()()}if(2&i){const e=r.$implicit;t.R7$(2),t.Y8G("src",e.cdnUrl,t.B4B),t.R7$(3),t.JRh(e.filename),t.R7$(2),t.AVh("bg-success",e.isPublic)("bg-secondary",!e.isPublic),t.R7$(),t.SpI(" ",e.isPublic?"Public":"Private"," "),t.R7$(3),t.SpI(" ",e.isPublic?"Make Private":"Make Public"," ")}}function dt(i,r){if(1&i&&t.Z7z(0,ct,14,8,"div",15,y),2&i){const e=t.XpG(3);t.Dyx(e.skyTextures)}}function pt(i,r){if(1&i&&t.DNE(0,lt,3,0,"div",1)(1,dt,2,0),2&i){const e=t.XpG(2);t.vxM(0,0===e.skyTextures.length?0:1)}}function mt(i,r){if(1&i&&(t.j41(0,"div",9),t.DNE(1,q,2,1)(2,ot,2,1)(3,at,2,1)(4,pt,2,1),t.k0s()),2&i){let e;const n=t.XpG();t.R7$(),t.vxM(1,(e=n.activeType())===n.TextureType.FLOOR?1:e===n.TextureType.WALL?2:e===n.TextureType.CEILING?3:e===n.TextureType.SKY?4:-1)}}let ut=(()=>{class i{constructor(){this.store=(0,t.WQX)(g.P),this.textureService=(0,t.WQX)(C.RV),this.toastr=(0,t.WQX)(v.tw),this.modalService=(0,t.WQX)(u.Bq),this.loading=(0,t.vPA)(!1),this.activeType=(0,t.vPA)(null),this.TextureType=p.Ap}get textures(){return this.store.textures()}get floorTextures(){return this.textures.filter(e=>e.type===p.Ap.FLOOR)}get wallTextures(){return this.textures.filter(e=>e.type===p.Ap.WALL)}get ceilingTextures(){return this.textures.filter(e=>e.type===p.Ap.CEILING)}get skyTextures(){return this.textures.filter(e=>e.type===p.Ap.SKY)}ngOnInit(){0===this.textures.length&&this.loadTextures(),null===this.activeType()&&Object.values(p.Ap).length>0&&this.activeType.set(p.Ap.FLOOR)}loadTextures(){this.loading.set(!0),this.textureService.getMyTextures({page:1,limit:100}).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:e=>{this.store.textures.set(e.data)},error:()=>this.toastr.error("Failed to load textures")})}setActiveType(e){this.activeType.set(e)}openUploadModal(e){const n=this.modalService.open(F.Xj,{size:"lg",centered:!0,backdrop:"static"});n.componentInstance.textureType=e,n.result.then(o=>{o.file&&this.uploadTexture(o.type,o.file,o.isPublic)},()=>{})}uploadTexture(e,n,o){this.loading.set(!0),this.textureService.uploadTexture(e,n,o).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:s=>{this.store.addTexture(s),this.toastr.success("Texture uploaded successfully")},error:()=>this.toastr.error("Failed to upload texture")})}toggleTexturePublic(e){this.loading.set(!0),this.textureService.update(e.id,{isPublic:!e.isPublic}).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:n=>{this.store.updateTexture(n),this.toastr.success("Texture visibility updated")},error:()=>this.toastr.error("Failed to update texture visibility")})}deleteTexture(e){confirm("Are you sure you want to delete this texture?")&&(this.loading.set(!0),this.textureService.remove(e).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:()=>{this.store.removeTexture(e),this.toastr.success("Texture deleted successfully")},error:()=>this.toastr.error("Failed to delete texture")}))}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-upload-textures"]],standalone:!0,features:[t.aNF],decls:14,vars:8,consts:[[1,"row","mb-4"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"d-flex","justify-content-center","mb-4"],[1,"nav","nav-tabs","mb-4"],[1,"nav-item"],[1,"mb-4"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-upload"],[1,"row"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"nav-link",3,"click"],[1,"badge","bg-secondary","ms-1"],[1,"alert","alert-info"],[1,"col-md-3","mb-4"],[1,"card","h-100"],["alt","Floor texture",1,"card-img-top",2,"height","160px","object-fit","cover",3,"src"],[1,"card-body"],[1,"card-title","text-truncate","mb-2"],[1,"d-flex","mb-2"],[1,"badge"],[1,"btn-group","btn-group-sm","w-100"],[1,"btn","btn-outline-primary",3,"click"],[1,"btn","btn-outline-danger",3,"click"],[1,"fa","fa-trash"],["alt","Wall texture",1,"card-img-top",2,"height","160px","object-fit","cover",3,"src"],["alt","Ceiling texture",1,"card-img-top",2,"height","160px","object-fit","cover",3,"src"],["alt","Sky texture",1,"card-img-top",2,"height","160px","object-fit","cover",3,"src"]],template:function(n,o){if(1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),t.EFF(4,"Texture Management"),t.k0s()(),t.DNE(5,W,4,0,"div",3),t.j41(6,"ul",4),t.Z7z(7,Y,7,4,"li",5,t.fX1),t.k0s(),t.j41(9,"div",6)(10,"button",7),t.bIt("click",function(){return o.openUploadModal(o.activeType()||o.TextureType.FLOOR)}),t.nrm(11,"i",8),t.EFF(12),t.k0s()(),t.DNE(13,mt,5,1,"div",9),t.k0s()()),2&n){let s;t.R7$(5),t.vxM(5,o.loading()?5:-1),t.R7$(2),t.Dyx(t.ziG(3,B,o.TextureType.FLOOR,o.TextureType.WALL,o.TextureType.CEILING,o.TextureType.SKY)),t.R7$(5),t.SpI(" Upload ",(null==(s=o.activeType())?null:s.toLowerCase())||"floor"," texture "),t.R7$(),t.vxM(13,o.activeType()?13:-1)}},dependencies:[f.MD,c.X1]})}}return i})();var b=l(9437),h=l(7673),_t=l(7468),$=l(2249);const ht=(i,r)=>r.id;function ft(i,r){1&i&&(t.j41(0,"div",3)(1,"div",29)(2,"span",30),t.EFF(3,"Loading..."),t.k0s()()())}function bt(i,r){1&i&&(t.j41(0,"div",14)(1,"small"),t.EFF(2,"Title is required (max 50 characters)"),t.k0s()())}function gt(i,r){1&i&&(t.j41(0,"div",14)(1,"small"),t.EFF(2,"Script content is required"),t.k0s()())}function vt(i,r){if(1&i){const e=t.RV6();t.j41(0,"button",31),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.cancelEdit())}),t.EFF(1," Cancel "),t.k0s()}}function Ct(i,r){1&i&&(t.j41(0,"p",28),t.EFF(1,"You haven't created any Hydra scripts yet."),t.k0s())}function yt(i,r){1&i&&(t.j41(0,"span",38),t.EFF(1,"Camera"),t.k0s())}function Ft(i,r){1&i&&(t.j41(0,"span",38),t.EFF(1,"Mic"),t.k0s())}function xt(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",33)(1,"div",34)(2,"div")(3,"h6",35),t.EFF(4),t.k0s(),t.j41(5,"div",36)(6,"span",37),t.EFF(7),t.k0s(),t.DNE(8,yt,2,0,"span",38)(9,Ft,2,0,"span",38),t.k0s()(),t.j41(10,"div",39)(11,"button",40),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.editScript(o))}),t.nrm(12,"i",41),t.k0s(),t.j41(13,"button",42),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.deleteScript(o.id))}),t.nrm(14,"i",43),t.k0s()()()()}if(2&i){const e=r.$implicit;t.R7$(4),t.JRh(e.title),t.R7$(2),t.AVh("bg-success",e.isPublic)("bg-secondary",!e.isPublic),t.R7$(),t.SpI(" ",e.isPublic?"Public":"Private"," "),t.R7$(),t.vxM(8,e.enableCamera?8:-1),t.R7$(),t.vxM(9,e.enableMic?9:-1)}}function jt(i,r){if(1&i&&(t.j41(0,"div",32),t.Z7z(1,xt,15,8,"div",33,ht),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Dyx(e.hydraScripts)}}let Tt=(()=>{class i{constructor(){this.store=(0,t.WQX)(g.P),this.hydraScriptService=(0,t.WQX)($.f),this.toastr=(0,t.WQX)(v.tw),this.loading=(0,t.vPA)(!1),this.editMode=(0,t.vPA)(!1),this.currentScriptId=(0,t.vPA)(null),this.formHydraScript=new c.gE({title:new c.MJ("",{validators:[c.k0.required,c.k0.maxLength(50)],nonNullable:!0}),hydraScript:new c.MJ("",{validators:[c.k0.required],nonNullable:!0}),enableCamera:new c.MJ(!1,{nonNullable:!0}),enableMic:new c.MJ(!1,{nonNullable:!0}),isPublic:new c.MJ(!1,{nonNullable:!0})})}get hydraScripts(){return this.store.hydraScripts()}ngOnInit(){this.loadScripts()}loadScripts(){this.loading.set(!0),this.hydraScriptService.getMyScripts({page:1,limit:100}).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:e=>{this.store.hydraScripts.set(e.data)},error:()=>this.toastr.error("Failed to load Hydra scripts")})}saveScript(){if(this.formHydraScript.invalid)return this.formHydraScript.markAllAsTouched(),void this.toastr.error("Please correct the form errors");const e=this.formHydraScript.getRawValue();this.loading.set(!0),this.editMode()?this.hydraScriptService.update(this.currentScriptId(),e).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:n=>{this.store.updateHydraScript(n),this.toastr.success("Hydra script updated successfully"),this.resetForm(),this.loadScripts()},error:()=>this.toastr.error("Failed to update Hydra script")}):this.hydraScriptService.create(e).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:n=>{this.store.addHydraScript(n),this.toastr.success("Hydra script created successfully"),this.resetForm(),this.loadScripts()},error:()=>this.toastr.error("Failed to create Hydra script")})}editScript(e){this.formHydraScript.patchValue({title:e.title,hydraScript:e.hydraScript,enableCamera:e.enableCamera,enableMic:e.enableMic,isPublic:e.isPublic}),this.editMode.set(!0),this.currentScriptId.set(e.id)}deleteScript(e){confirm("Are you sure you want to delete this Hydra script?")&&(this.loading.set(!0),this.hydraScriptService.remove(e).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:()=>{this.store.removeHydraScript(e),this.toastr.success("Hydra script deleted successfully"),this.currentScriptId()===e&&this.resetForm(),this.loadScripts()},error:()=>this.toastr.error("Failed to delete Hydra script")}))}cancelEdit(){this.resetForm()}resetForm(){this.formHydraScript.reset({title:"",hydraScript:"",enableCamera:!1,enableMic:!1,isPublic:!1}),this.editMode.set(!1),this.currentScriptId.set(null)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-hydra-script"]],standalone:!0,features:[t.aNF],decls:51,vars:9,consts:[[1,"row","mb-4"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"d-flex","justify-content-center","mb-4"],[1,"row"],[1,"col-md-6"],[1,"card","mb-4"],[1,"card-header"],[1,"mb-0"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","title",1,"form-label"],["type","text","id","title","formControlName","title","placeholder","Enter script title",1,"form-control"],[1,"text-danger","mt-1"],["for","hydraScript",1,"form-label"],["id","hydraScript","formControlName","hydraScript","rows","12","placeholder","Enter your Hydra code here",1,"form-control"],[1,"form-check","form-switch"],["type","checkbox","id","enableCamera","formControlName","enableCamera",1,"form-check-input"],["for","enableCamera",1,"form-check-label"],["type","checkbox","id","enableMic","formControlName","enableMic",1,"form-check-input"],["for","enableMic",1,"form-check-label"],["type","checkbox","id","isPublic","formControlName","isPublic",1,"form-check-input"],["for","isPublic",1,"form-check-label"],[1,"d-grid","gap-2","d-md-flex","justify-content-md-end"],["type","button",1,"btn","btn-secondary"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"card"],[1,"text-muted"],["role","status",1,"spinner-border"],[1,"visually-hidden"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"list-group"],[1,"list-group-item","list-group-item-action"],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-1"],[1,"d-flex","gap-2"],[1,"badge"],[1,"badge","bg-info"],[1,"btn-group"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"fa","fa-edit"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"fa","fa-trash"]],template:function(n,o){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),t.EFF(4,"Hydra Scripts"),t.k0s()(),t.DNE(5,ft,4,0,"div",3),t.j41(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7)(10,"h5",8),t.EFF(11),t.k0s()(),t.j41(12,"div",9)(13,"form",10),t.bIt("ngSubmit",function(){return o.saveScript()}),t.j41(14,"div",11)(15,"label",12),t.EFF(16,"Title"),t.k0s(),t.nrm(17,"input",13),t.DNE(18,bt,3,0,"div",14),t.k0s(),t.j41(19,"div",11)(20,"label",15),t.EFF(21,"Hydra Script"),t.k0s(),t.nrm(22,"textarea",16),t.DNE(23,gt,3,0,"div",14),t.k0s(),t.j41(24,"div",11)(25,"div",17),t.nrm(26,"input",18),t.j41(27,"label",19),t.EFF(28," Enable Camera "),t.k0s()()(),t.j41(29,"div",11)(30,"div",17),t.nrm(31,"input",20),t.j41(32,"label",21),t.EFF(33," Enable Microphone "),t.k0s()()(),t.j41(34,"div",11)(35,"div",17),t.nrm(36,"input",22),t.j41(37,"label",23),t.EFF(38," Make Public "),t.k0s()()(),t.j41(39,"div",24),t.DNE(40,vt,2,0,"button",25),t.j41(41,"button",26),t.EFF(42),t.k0s()()()()()(),t.j41(43,"div",5)(44,"div",27)(45,"div",7)(46,"h5",8),t.EFF(47,"Your Hydra Scripts"),t.k0s()(),t.j41(48,"div",9),t.DNE(49,Ct,2,0,"p",28)(50,jt,3,0),t.k0s()()()()()()),2&n&&(t.R7$(5),t.vxM(5,o.loading()?5:-1),t.R7$(6),t.JRh(o.editMode()?"Edit Script":"Create New Script"),t.R7$(2),t.Y8G("formGroup",o.formHydraScript),t.R7$(5),t.vxM(18,o.formHydraScript.controls.title.invalid&&o.formHydraScript.controls.title.touched?18:-1),t.R7$(5),t.vxM(23,o.formHydraScript.controls.hydraScript.invalid&&o.formHydraScript.controls.hydraScript.touched?23:-1),t.R7$(17),t.vxM(40,o.editMode()?40:-1),t.R7$(),t.Y8G("disabled",o.loading()),t.R7$(),t.SpI(" ",o.editMode()?"Update Script":"Create Script"," "),t.R7$(7),t.vxM(49,0!==o.hydraScripts.length||o.loading()?50:49))},dependencies:[f.MD,c.X1,c.qT,c.me,c.Zm,c.BC,c.cb,c.j4,c.JD]})}}return i})(),G=(()=>{class i extends T.v{constructor(e){super(e),this.http=e,this.endpoint="three-d-objects"}getMyObjects(e){return this.http.get(`${this.apiUrl}/${this.endpoint}/my-objects`,{params:{...e}})}upload(e){return this.http.post(`${this.apiUrl}/${this.endpoint}`,e)}updateWithFiles(e,n){return this.http.patch(`${this.apiUrl}/${this.endpoint}/${e}`,n)}static{this.\u0275fac=function(n){return new(n||i)(t.KVO(k.Qq))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();const O=(i,r)=>r.id;function kt(i,r){1&i&&(t.j41(0,"div",5)(1,"div",11)(2,"span",12),t.EFF(3,"Loading..."),t.k0s()()())}function Rt(i,r){1&i&&(t.j41(0,"div",1)(1,"div",13),t.EFF(2," No mesh objects found. Upload some to get started. "),t.k0s()())}function St(i,r){1&i&&(t.j41(0,"span",22),t.EFF(1,"Has Textures"),t.k0s())}function Et(i,r){1&i&&(t.j41(0,"span",23),t.EFF(1,"AI Generated"),t.k0s())}function $t(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",14)(1,"div",15),t.nrm(2,"img",16),t.j41(3,"div",17)(4,"h5",18),t.EFF(5),t.k0s(),t.j41(6,"p",19),t.EFF(7),t.k0s(),t.j41(8,"div",20)(9,"span",21),t.EFF(10),t.k0s(),t.DNE(11,St,2,0,"span",22)(12,Et,2,0,"span",23),t.k0s(),t.j41(13,"div",24)(14,"button",25),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(4);return t.Njj(s.openEditModal(o))}),t.nrm(15,"i",26),t.EFF(16," Edit "),t.k0s(),t.j41(17,"button",27),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(4);return t.Njj(s.deleteObject(o.id))}),t.nrm(18,"i",28),t.EFF(19," Delete "),t.k0s()()(),t.j41(20,"div",29),t.EFF(21),t.k0s()()()}if(2&i){const e=r.$implicit;t.R7$(2),t.Y8G("src",e.thumbnailUrl,t.B4B),t.R7$(3),t.JRh(e.title),t.R7$(2),t.JRh(e.shortDescription),t.R7$(2),t.AVh("bg-success",e.isPublic)("bg-secondary",!e.isPublic),t.R7$(),t.SpI(" ",e.isPublic?"Public":"Private"," "),t.R7$(),t.vxM(11,e.hasTextures?11:-1),t.R7$(),t.vxM(12,e.metadata.aiGenerated?12:-1),t.R7$(9),t.Lme(" Format: ",e.metadata.fileFormat," | Size: ",(e.metadata.fileSize/1024/1024).toFixed(2)," MB ")}}function Gt(i,r){if(1&i&&t.Z7z(0,$t,22,12,"div",14,O),2&i){const e=t.XpG(3);t.Dyx(e.meshObjects)}}function Ot(i,r){if(1&i&&t.DNE(0,Rt,3,0,"div",1)(1,Gt,2,0),2&i){const e=t.XpG(2);t.vxM(0,0===e.meshObjects.length?0:1)}}function Mt(i,r){1&i&&(t.j41(0,"div",1)(1,"div",13),t.EFF(2," No point cloud objects found. Upload some to get started. "),t.k0s()())}function Pt(i,r){1&i&&(t.j41(0,"span",23),t.EFF(1,"AI Generated"),t.k0s())}function Dt(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",14)(1,"div",15),t.nrm(2,"img",16),t.j41(3,"div",17)(4,"h5",18),t.EFF(5),t.k0s(),t.j41(6,"p",19),t.EFF(7),t.k0s(),t.j41(8,"div",20)(9,"span",21),t.EFF(10),t.k0s(),t.DNE(11,Pt,2,0,"span",23),t.k0s(),t.j41(12,"div",24)(13,"button",25),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(4);return t.Njj(s.openEditModal(o))}),t.nrm(14,"i",26),t.EFF(15," Edit "),t.k0s(),t.j41(16,"button",27),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(4);return t.Njj(s.deleteObject(o.id))}),t.nrm(17,"i",28),t.EFF(18," Delete "),t.k0s()()(),t.j41(19,"div",29),t.EFF(20),t.k0s()()()}if(2&i){const e=r.$implicit;t.R7$(2),t.Y8G("src",e.thumbnailUrl,t.B4B),t.R7$(3),t.JRh(e.title),t.R7$(2),t.JRh(e.shortDescription),t.R7$(2),t.AVh("bg-success",e.isPublic)("bg-secondary",!e.isPublic),t.R7$(),t.SpI(" ",e.isPublic?"Public":"Private"," "),t.R7$(),t.vxM(11,e.metadata.aiGenerated?11:-1),t.R7$(9),t.Lme(" Format: ",e.metadata.fileFormat," | Size: ",(e.metadata.fileSize/1024/1024).toFixed(2)," MB ")}}function Vt(i,r){if(1&i&&t.Z7z(0,Dt,21,11,"div",14,O),2&i){const e=t.XpG(3);t.Dyx(e.pointCloudObjects)}}function It(i,r){if(1&i&&t.DNE(0,Mt,3,0,"div",1)(1,Vt,2,0),2&i){const e=t.XpG(2);t.vxM(0,0===e.pointCloudObjects.length?0:1)}}function Nt(i,r){if(1&i&&(t.j41(0,"div",10),t.DNE(1,Ot,2,1)(2,It,2,1),t.k0s()),2&i){let e;const n=t.XpG();t.R7$(),t.vxM(1,(e=n.activeType())===n.ThreeDObjectType.MESH?1:e===n.ThreeDObjectType.POINT_CLOUD?2:-1)}}let wt=(()=>{class i{constructor(){this.store=(0,t.WQX)(g.P),this.threeDObjectService=(0,t.WQX)(G),this.toastr=(0,t.WQX)(v.tw),this.modalService=(0,t.WQX)(u.Bq),this.loading=(0,t.vPA)(!1),this.activeType=(0,t.vPA)(p.ex.MESH),this.ThreeDObjectType=p.ex}get objects(){return this.store.threeDObjects()}get meshObjects(){return this.objects.filter(e=>e.metadata.objectType===p.ex.MESH)}get pointCloudObjects(){return this.objects.filter(e=>e.metadata.objectType===p.ex.POINT_CLOUD)}ngOnInit(){this.loadObjects()}loadObjects(){this.loading.set(!0),this.threeDObjectService.getMyObjects({page:1,limit:100}).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:e=>{this.store.threeDObjects.set(e.data)},error:()=>this.toastr.error("Failed to load 3D objects")})}setActiveType(e){this.activeType.set(e)}openUploadModal(){this.modalService.open(F._z,{size:"lg",centered:!0,backdrop:"static"}).result.then(n=>{if(n){const o=new FormData;Object.entries(n.formValues).forEach(([s,a])=>{null!=a&&o.append(s,a.toString())}),n.objectFile&&o.append("objectFile",n.objectFile),n.thumbnailFile&&o.append("thumbnailFile",n.thumbnailFile),n.textureFile&&o.append("textureFile",n.textureFile),this.uploadObject(o)}},()=>{})}openEditModal(e){const n=this.modalService.open(F._z,{size:"lg",centered:!0,backdrop:"static"});n.componentInstance.object=e,n.result.then(o=>{if(o){const s=new FormData;Object.entries(o.formValues).forEach(([a,m])=>{null!=m&&s.append(a,m.toString())}),o.objectFile&&s.append("objectFile",o.objectFile),o.thumbnailFile&&s.append("thumbnailFile",o.thumbnailFile),o.textureFile&&s.append("textureFile",o.textureFile),this.uploadObject(s)}})}uploadObject(e){this.loading.set(!0),e.forEach((n,o)=>{console.log(o,n)}),this.threeDObjectService.upload(e).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:n=>{this.store.addThreeDObject(n),this.toastr.success("3D object uploaded successfully")},error:()=>this.toastr.error("Failed to upload 3D object")})}updateObject(e,n){this.loading.set(!0),this.threeDObjectService.updateWithFiles(e,n).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:o=>{this.store.updateThreeDObject(o),this.toastr.success("3D object updated successfully")},error:()=>this.toastr.error("Failed to update 3D object")})}deleteObject(e){confirm("Are you sure you want to delete this 3D object?")&&(this.loading.set(!0),this.threeDObjectService.remove(e).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:()=>{this.store.removeThreeDObject(e),this.toastr.success("3D object deleted successfully")},error:()=>this.toastr.error("Failed to delete 3D object")}))}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-three-d-objects"]],standalone:!0,features:[t.aNF],decls:21,vars:8,consts:[[1,"row","mb-4"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-plus"],[1,"d-flex","justify-content-center","mb-4"],[1,"nav","nav-tabs","mb-4"],[1,"nav-item"],[1,"nav-link",3,"click"],[1,"badge","bg-secondary","ms-1"],[1,"row"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"alert","alert-info"],[1,"col-md-4","mb-4"],[1,"card","h-100"],["alt","Object thumbnail",1,"card-img-top",2,"height","160px","object-fit","cover",3,"src"],[1,"card-body"],[1,"card-title","text-truncate","mb-2"],[1,"card-text","small","text-truncate"],[1,"d-flex","mb-2"],[1,"badge"],[1,"badge","bg-info","ms-1"],[1,"badge","bg-warning","ms-1"],[1,"btn-group","btn-group-sm","w-100"],[1,"btn","btn-outline-primary",3,"click"],[1,"fa","fa-edit"],[1,"btn","btn-outline-danger",3,"click"],[1,"fa","fa-trash"],[1,"card-footer","text-muted","small"]],template:function(n,o){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),t.EFF(4,"3D Object Management"),t.k0s(),t.j41(5,"button",3),t.bIt("click",function(){return o.openUploadModal()}),t.nrm(6,"i",4),t.EFF(7," Upload 3D Object "),t.k0s()(),t.DNE(8,kt,4,0,"div",5),t.j41(9,"ul",6)(10,"li",7)(11,"button",8),t.bIt("click",function(){return o.setActiveType(o.ThreeDObjectType.MESH)}),t.EFF(12," Mesh Objects "),t.j41(13,"span",9),t.EFF(14),t.k0s()()(),t.j41(15,"li",7)(16,"button",8),t.bIt("click",function(){return o.setActiveType(o.ThreeDObjectType.POINT_CLOUD)}),t.EFF(17," Point Cloud Objects "),t.j41(18,"span",9),t.EFF(19),t.k0s()()()(),t.DNE(20,Nt,3,1,"div",10),t.k0s()()),2&n&&(t.R7$(8),t.vxM(8,o.loading()?8:-1),t.R7$(3),t.AVh("active",o.activeType()===o.ThreeDObjectType.MESH),t.R7$(3),t.JRh(o.meshObjects.length),t.R7$(2),t.AVh("active",o.activeType()===o.ThreeDObjectType.POINT_CLOUD),t.R7$(3),t.JRh(o.pointCloudObjects.length),t.R7$(),t.vxM(20,o.activeType()?20:-1))},dependencies:[f.MD,c.X1]})}}return i})();var M=l(4942);const Xt=(i,r)=>r.id;function At(i,r){1&i&&(t.j41(0,"div",9)(1,"div",11)(2,"span",12),t.EFF(3,"Loading..."),t.k0s()()())}function Ut(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",13),t.nrm(1,"i",15),t.j41(2,"p"),t.EFF(3),t.k0s(),t.j41(4,"button",16),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.openUploadModal())}),t.EFF(5),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(3),t.SpI("No ",e.activeType()," geometries yet"),t.R7$(2),t.SpI(" Upload Your First ",e.activeType()," Geometry ")}}function Bt(i,r){if(1&i&&t.nrm(0,"img",17),2&i){const e=t.XpG().$implicit;t.Y8G("src",e.thumbnailUrl,t.B4B)("alt",e.name)}}function Wt(i,r){1&i&&(t.j41(0,"div",25),t.nrm(1,"i",15),t.k0s())}function Lt(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",14),t.DNE(1,Bt,1,2,"img",17)(2,Wt,2,0),t.j41(3,"div",18)(4,"h5"),t.EFF(5),t.k0s(),t.j41(6,"span",19),t.EFF(7),t.k0s()(),t.j41(8,"div",20)(9,"button",21),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.openEditModal(o))}),t.nrm(10,"i",22),t.k0s(),t.j41(11,"button",23),t.bIt("click",function(){const o=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.deleteGeometry(o.id))}),t.nrm(12,"i",24),t.k0s()()()}if(2&i){const e=r.$implicit;t.R7$(),t.vxM(1,e.thumbnailUrl?1:2),t.R7$(4),t.JRh(e.name),t.R7$(),t.AVh("badge-primary",e.isPublic)("badge-secondary",!e.isPublic),t.R7$(),t.SpI(" ",e.isPublic?"Public":"Private"," ")}}function Ht(i,r){if(1&i&&(t.j41(0,"div",10),t.DNE(1,Ut,6,2,"div",13),t.Z7z(2,Lt,13,7,"div",14,Xt),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(1,0===e.filteredGeometries().length?1:-1),t.R7$(),t.Dyx(e.filteredGeometries())}}let Qt=(()=>{class i{constructor(){this.store=(0,t.WQX)(g.P),this.roomGeometryService=(0,t.WQX)(R),this.toastr=(0,t.WQX)(v.tw),this.modalService=(0,t.WQX)(u.Bq),this.loading=(0,t.vPA)(!1),this.activeType=(0,t.vPA)(p.GF.FLOOR),this.RoomGeometryType=p.GF,this.geometries=(0,t.EWP)(()=>this.store.roomGeometries()),this.filteredGeometries=(0,t.EWP)(()=>{const e=this.activeType();return this.geometries().filter(n=>n.type===e)})}ngOnInit(){this.loadGeometries()}loadGeometries(){this.loading.set(!0),this.roomGeometryService.getMyGeometries({page:1,limit:100}).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:e=>{this.store.roomGeometries.set(e.data)},error:()=>this.toastr.error("Failed to load room geometries")})}setActiveType(e){this.activeType.set(e)}openUploadModal(){this.modalService.open(M.M,{size:"lg",centered:!0,backdrop:"static"}).result.then(n=>{if(n){const o=new FormData;Object.entries(n.formValues).forEach(([s,a])=>{null!=a&&o.append(s,a.toString())}),n.geometryFile&&o.append("geometryFile",n.geometryFile),n.thumbnailFile&&o.append("thumbnailFile",n.thumbnailFile),this.uploadGeometry(o)}},()=>{})}openEditModal(e){const n=this.modalService.open(M.M,{size:"lg",centered:!0,backdrop:"static"});n.componentInstance.geometry=e,n.result.then(o=>{if(o){const s=new FormData;Object.entries(o.formValues).forEach(([a,m])=>{null!=m&&s.append(a,m.toString())}),o.thumbnailFile&&s.append("thumbnailFile",o.thumbnailFile),this.updateGeometry(e.id,s)}},()=>{})}uploadGeometry(e){this.loading.set(!0),this.roomGeometryService.upload(e).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:n=>{this.store.addRoomGeometry(n),this.toastr.success("Room geometry uploaded successfully")},error:()=>this.toastr.error("Failed to upload room geometry")})}updateGeometry(e,n){this.loading.set(!0),this.roomGeometryService.updateWithFiles(e,n).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:o=>{this.store.updateRoomGeometry(o),this.toastr.success("Room geometry updated successfully")},error:()=>this.toastr.error("Failed to update room geometry")})}deleteGeometry(e){confirm("Are you sure you want to delete this room geometry?")&&(this.loading.set(!0),this.roomGeometryService.remove(e).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:()=>{this.store.removeRoomGeometry(e),this.toastr.success("Room geometry deleted successfully")},error:()=>this.toastr.error("Failed to delete room geometry")}))}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-room-geometries"]],standalone:!0,features:[t.aNF],decls:19,vars:9,consts:[[1,"room-geometries-container"],[1,"header-section"],[1,"btn","btn-primary",3,"click","disabled"],[1,"bi","bi-plus-circle"],[1,"geometry-tabs"],[1,"tab-btn",3,"click"],[1,"bi","bi-square"],[1,"bi","bi-box"],[1,"bi","bi-square-fill"],[1,"loading-state"],[1,"geometries-grid"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"empty-state"],[1,"geometry-card"],[1,"bi","bi-cube"],[1,"btn","btn-outline-primary",3,"click"],[1,"geometry-thumbnail",3,"src","alt"],[1,"geometry-info"],[1,"badge"],[1,"geometry-actions"],["title","Edit",1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"bi","bi-pencil"],["title","Delete",1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"bi","bi-trash"],[1,"geometry-thumbnail-placeholder"]],template:function(n,o){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"h2"),t.EFF(3,"Room Geometries"),t.k0s(),t.j41(4,"button",2),t.bIt("click",function(){return o.openUploadModal()}),t.nrm(5,"i",3),t.EFF(6," Upload Geometry "),t.k0s()(),t.j41(7,"div",4)(8,"button",5),t.bIt("click",function(){return o.setActiveType(o.RoomGeometryType.FLOOR)}),t.nrm(9,"i",6),t.EFF(10," Floor "),t.k0s(),t.j41(11,"button",5),t.bIt("click",function(){return o.setActiveType(o.RoomGeometryType.WALLS)}),t.nrm(12,"i",7),t.EFF(13," Walls "),t.k0s(),t.j41(14,"button",5),t.bIt("click",function(){return o.setActiveType(o.RoomGeometryType.CEILING)}),t.nrm(15,"i",8),t.EFF(16," Ceiling "),t.k0s()(),t.DNE(17,At,4,0,"div",9)(18,Ht,4,1,"div",10),t.k0s()),2&n&&(t.R7$(4),t.Y8G("disabled",o.loading()),t.R7$(4),t.AVh("active",o.activeType()===o.RoomGeometryType.FLOOR),t.R7$(3),t.AVh("active",o.activeType()===o.RoomGeometryType.WALLS),t.R7$(3),t.AVh("active",o.activeType()===o.RoomGeometryType.CEILING),t.R7$(3),t.vxM(17,o.loading()?17:-1),t.R7$(),t.vxM(18,o.loading()?-1:18))},dependencies:[f.MD,c.X1],styles:[".room-geometries-container[_ngcontent-%COMP%]{padding:2rem}.header-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.header-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.75rem;font-weight:600}.geometry-tabs[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-bottom:2rem;border-bottom:2px solid #e0e0e0}.tab-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;background:transparent;color:#666;font-weight:500;cursor:pointer;transition:all .3s ease;border-bottom:3px solid transparent}.tab-btn[_ngcontent-%COMP%]:hover{color:#007bff;background:#f8f9fa}.tab-btn.active[_ngcontent-%COMP%]{color:#007bff;border-bottom-color:#007bff}.tab-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.5rem}.loading-state[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:300px}.geometries-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:1.5rem}.geometry-card[_ngcontent-%COMP%]{border:1px solid #e0e0e0;border-radius:12px;overflow:hidden;transition:all .3s ease;background:#fff}.geometry-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a;transform:translateY(-2px)}.geometry-thumbnail[_ngcontent-%COMP%]{width:100%;height:180px;object-fit:cover}.geometry-thumbnail-placeholder[_ngcontent-%COMP%]{width:100%;height:180px;display:flex;align-items:center;justify-content:center;background:#f0f0f0;color:#999;font-size:3rem}.geometry-info[_ngcontent-%COMP%]{padding:1rem}.geometry-info[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.1rem;font-weight:600;color:#333}.badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:12px;font-size:.75rem;font-weight:500}.badge-primary[_ngcontent-%COMP%]{background:#007bff;color:#fff}.badge-secondary[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.geometry-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;padding:0 1rem 1rem}.geometry-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1}.empty-state[_ngcontent-%COMP%]{grid-column:1 / -1;text-align:center;padding:4rem 2rem;color:#999}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem;opacity:.5}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:1.5rem}"]})}}return i})();function zt(i,r){1&i&&(t.j41(0,"div",5)(1,"div",11)(2,"span",12),t.EFF(3,"Loading..."),t.k0s()()())}function Yt(i,r){1&i&&t.nrm(0,"app-vr-base-config")}function Jt(i,r){1&i&&t.nrm(0,"app-upload-textures")}function Zt(i,r){1&i&&t.nrm(0,"app-hydra-script")}function Kt(i,r){1&i&&t.nrm(0,"app-three-d-objects")}function qt(i,r){1&i&&t.nrm(0,"app-room-geometries")}let te=(()=>{class i{constructor(){this.store=(0,t.WQX)(g.P),this.vrConfigService=(0,t.WQX)(j.$),this.textureService=(0,t.WQX)(C.RV),this.artistService=(0,t.WQX)(C.gA),this.artworkService=(0,t.WQX)(C.UN),this.seriesService=(0,t.WQX)(C.xB),this.hydraScriptService=(0,t.WQX)($.f),this.threeDObjectService=(0,t.WQX)(G),this.toastr=(0,t.WQX)(v.tw),this.modalService=(0,t.WQX)(u.Bq),this.activeTab=(0,t.vPA)(1),this.loading=(0,t.vPA)(!1),this.profileLoaded=(0,t.vPA)(!1),this.vrConfigs=(0,t.vPA)([]),this.textures=(0,t.vPA)([])}ngOnInit(){this.loadData()}loadData(){this.loading.set(!0);const e=this.vrConfigService.getMyConfigs({page:1,limit:25}).pipe((0,b.W)(()=>(0,h.of)({data:[]}))),n=this.textureService.getMyTextures({page:1,limit:50}).pipe((0,b.W)(()=>(0,h.of)({data:[]}))),o=this.hydraScriptService.getMyScripts({page:1,limit:50}).pipe((0,b.W)(()=>(0,h.of)({data:[]}))),s=this.store.threeDObjects().length>0?(0,h.of)({data:this.store.threeDObjects()}):this.threeDObjectService.getMyObjects({page:1,limit:50}).pipe((0,b.W)(()=>(0,h.of)({data:[]}))),a=this.store.series().length>0?(0,h.of)({data:this.store.series()}):this.seriesService.getMySeries({page:1,limit:50}).pipe((0,b.W)(()=>(0,h.of)({data:[]}))),m=this.store.artistProfile()?(0,h.of)(this.store.artistProfile()):this.artistService.getMyProfile().pipe((0,b.W)(()=>(0,h.of)(null))),ee=this.store.artworks().length>0?(0,h.of)({data:this.store.artworks()}):this.artworkService.getMyArtworks({page:1,limit:100}).pipe((0,b.W)(()=>(0,h.of)({data:[]})));(0,_t.p)({configs:e,textures:n,series:a,profile:m,artworks:ee,hydraScripts:o,threeDObjects:s}).pipe((0,d.j)(()=>this.loading.set(!1))).subscribe({next:_=>{this.vrConfigs.set(_.configs.data),this.store.vrConfigs.set(_.configs.data),this.textures.set(_.textures.data),this.store.hydraScripts.set(_.hydraScripts.data),this.store.textures.set(_.textures.data),0===this.store.series().length&&_.series.data.length>0&&this.store.series.set(_.series.data),0===this.store.artworks().length&&_.artworks.data.length>0&&this.store.artworks.set(_.artworks.data),_.profile&&!this.store.artistProfile()&&this.store.setArtistProfile(_.profile),0===this.store.threeDObjects().length&&_.threeDObjects.data.length>0&&this.store.threeDObjects.set(_.threeDObjects.data)},error:()=>this.toastr.error("Failed to load data")})}onTabChange(e){this.activeTab.set(e)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-vr-gallery"]],standalone:!0,features:[t.aNF],decls:31,vars:8,consts:[["nav","ngbNav"],[1,"container","my-4"],[1,"row","mb-4"],[1,"col-12"],[1,"lead"],[1,"d-flex","justify-content-center","mb-4"],["ngbNav","",1,"nav-tabs","mb-4",3,"navChange","activeId"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[3,"ngbNavOutlet"],["role","status",1,"spinner-border"],[1,"visually-hidden"]],template:function(n,o){if(1&n){const s=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2"),t.EFF(4,"VR Gallery Management"),t.k0s(),t.j41(5,"p",4),t.EFF(6,"Configure your VR galleries and manage textures"),t.k0s()()(),t.DNE(7,zt,4,0,"div",5),t.j41(8,"ul",6,0),t.bIt("navChange",function(m){return t.eBV(s),t.Njj(o.onTabChange(m.nextId))}),t.j41(10,"li",7)(11,"a",8),t.EFF(12,"VR Configurations"),t.k0s(),t.DNE(13,Yt,1,0,"ng-template",9),t.k0s(),t.j41(14,"li",7)(15,"a",8),t.EFF(16,"Texture Management"),t.k0s(),t.DNE(17,Jt,1,0,"ng-template",9),t.k0s(),t.j41(18,"li",7)(19,"a",8),t.EFF(20,"Hydra Scripts"),t.k0s(),t.DNE(21,Zt,1,0,"ng-template",9),t.k0s(),t.j41(22,"li",7)(23,"a",8),t.EFF(24,"3D Objects"),t.k0s(),t.DNE(25,Kt,1,0,"ng-template",9),t.k0s(),t.j41(26,"li",7)(27,"a",8),t.EFF(28,"Room Geometries"),t.k0s(),t.DNE(29,qt,1,0,"ng-template",9),t.k0s()(),t.nrm(30,"div",10),t.k0s()}if(2&n){const s=t.sdS(9);t.R7$(7),t.vxM(7,o.loading()?7:-1),t.R7$(),t.Y8G("activeId",o.activeTab()),t.R7$(2),t.Y8G("ngbNavItem",1),t.R7$(4),t.Y8G("ngbNavItem",2),t.R7$(4),t.Y8G("ngbNavItem",3),t.R7$(4),t.Y8G("ngbNavItem",4),t.R7$(4),t.Y8G("ngbNavItem",5),t.R7$(4),t.Y8G("ngbNavOutlet",s)}},dependencies:[f.MD,c.X1,U,ut,Tt,wt,Qt,u.Pv,u.Um,u.X9,u.sy,u.Gx,u.Ri,u.WA,u.m_]})}}return i})()}}]);